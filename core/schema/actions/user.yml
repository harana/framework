- name: Check User Permission
  action: check_permission
  inputs:
    action: string #required
    resource: string #required
    user_id: string #required
  outputs:
    allowed: boolean
    reason: string

- name: Grant Permission To User
  action: grant_permission
  inputs:
    action: string #required
    conditions: UserPermissionConditions
    expires_at: datetime
    resource: string #required
    user_id: string #required
  outputs:
    permission_id: string
    success: boolean

- name: Revoke User Permission
  action: revoke_permission
  inputs:
    permission_id: string #required
    user_id: string #required
  outputs:
    success: boolean

- name: List User Permissions
  action: list_permissions
  inputs:
    resource: string
    user_id: string #required
  outputs:
    permissions: list[UserPermissionInfo]
    total: integer

- name: Assign Role To User
  action: assign_role
  inputs:
    role_id: string #required
    user_id: string #required
  outputs:
    success: boolean

- name: Remove Role From User
  action: remove_role
  inputs:
    role_id: string #required
    user_id: string #required
  outputs:
    success: boolean

- name: List User Roles
  action: list_roles
  inputs:
    user_id: string #required
  outputs:
    roles: list[UserRoleInfo]
    total: integer

- name: Get User Effective Permissions
  action: get_effective_permissions
  inputs:
    resource: string
    user_id: string #required
  outputs:
    permissions: list[EffectivePermission]
    sources: list[PermissionSource]

- name: UserPermission
  class:
    permission_id: string
    user_id: string
    action: string
    resource: string
    conditions: UserPermissionConditions
    expires_at: datetime

- name: UserPermissionConditions
  class:
    conditions: map[string, any]

- name: UserPermissionInfo
  class:
    permission_id: string
    action: string
    resource: string
    expires_at: datetime

- name: UserRoleInfo
  class:
    role_id: string
    name: string
    assigned_at: datetime

- name: EffectivePermission
  class:
    action: string
    resource: string
    allowed: boolean

- name: PermissionSource
  class:
    source_type: string
    source_id: string
    name: string
