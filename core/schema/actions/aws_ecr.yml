- name: Create ECR Repository
  action: create_repository
  inputs:
    encryption_type: AES256 | KMS
    image_tag_mutability: MUTABLE | IMMUTABLE = MUTABLE
    kms_key: string
    region: string
    repository_name: string #required
    scan_on_push: boolean = false
    tags: EcrTags
  outputs:
    registry_id: string
    repository_arn: string
    repository_uri: string
    success: boolean

- name: Delete ECR Repository
  action: delete_repository
  inputs:
    force: boolean = false
    region: string
    repository_name: string #required
  outputs:
    success: boolean

- name: Describe ECR Repositories
  action: describe_repositories
  inputs:
    region: string
    repository_names: list[string]
  outputs:
    repositories: list[EcrRepository]

- name: List ECR Images
  action: list_images
  inputs:
    filter: ImageFilter
    max_results: integer = 100
    region: string
    repository_name: string #required
  outputs:
    image_ids: list[ImageId]
    next_token: string

- name: Describe ECR Images
  action: describe_images
  inputs:
    image_ids: list[ImageId]
    region: string
    repository_name: string #required
  outputs:
    image_details: list[EcrImageDetail]

- name: Put ECR Image
  action: put_image
  inputs:
    image_manifest: string #required
    image_tag: string #required
    region: string
    repository_name: string #required
  outputs:
    image: EcrImage
    success: boolean

- name: Batch Delete ECR Image
  action: batch_delete_image
  inputs:
    image_ids: list[ImageId] #required
    region: string
    repository_name: string #required
  outputs:
    failures: list[ImageFailure]
    image_ids: list[ImageId]
    success: boolean

- name: Get ECR Authorization Token
  action: get_auth_token
  inputs:
    region: string
    registry_ids: list[string]
  outputs:
    authorization_token: string
    expires_at: datetime
    proxy_endpoint: string
    success: boolean

- name: Get ECR Download URL
  action: get_download_url
  inputs:
    image_digest: string #required
    region: string
    repository_name: string #required
  outputs:
    download_url: string
    success: boolean

- name: Tag ECR Image
  action: tag_image
  inputs:
    image_digest: string #required
    image_tag: string #required
    region: string
    repository_name: string #required
  outputs:
    success: boolean

- name: Set Repository Policy
  action: set_repository_policy
  inputs:
    force: boolean = false
    policy_text: string #required
    region: string
    repository_name: string #required
  outputs:
    policy_text: string
    registry_id: string
    repository_name: string
    success: boolean

- name: Get Repository Policy
  action: get_repository_policy
  inputs:
    region: string
    repository_name: string #required
  outputs:
    policy_text: string
    registry_id: string
    repository_name: string

- name: Delete Repository Policy
  action: delete_repository_policy
  inputs:
    region: string
    repository_name: string #required
  outputs:
    success: boolean

- name: Start Image Scan
  action: start_image_scan
  inputs:
    image_id: ImageId #required
    region: string
    repository_name: string #required
  outputs:
    image_id: ImageId
    scan_status: string
    success: boolean

- name: Describe Image Scan Findings
  action: describe_scan_findings
  inputs:
    image_id: ImageId #required
    max_results: integer = 100
    region: string
    repository_name: string #required
  outputs:
    findings: list[ImageScanFinding]
    image_scan_status: ImageScanStatus
    next_token: string

- name: Put Lifecycle Policy
  action: put_lifecycle_policy
  inputs:
    lifecycle_policy_text: string #required
    region: string
    repository_name: string #required
  outputs:
    lifecycle_policy_text: string
    registry_id: string
    repository_name: string
    success: boolean

- name: Get Lifecycle Policy
  action: get_lifecycle_policy
  inputs:
    region: string
    repository_name: string #required
  outputs:
    last_evaluated_at: datetime
    lifecycle_policy_text: string
    registry_id: string
    repository_name: string

- name: EcrRepository
  class:
    repository_name: string
    repository_uri: string
    repository_arn: string
    registry_id: string
    image_tag_mutability: string
    scan_on_push: boolean
    encryption_type: string
    created_at: datetime

- name: EcrTags
  class:
    items: list[EcrTag]

- name: EcrTag
  class:
    key: string
    value: string

- name: ImageFilter
  class:
    tag_status: string

- name: ImageId
  class:
    image_digest: string
    image_tag: string

- name: EcrImage
  class:
    registry_id: string
    repository_name: string
    image_id: ImageId
    image_manifest: string
    image_manifest_media_type: string

- name: EcrImageDetail
  class:
    registry_id: string
    repository_name: string
    image_digest: string
    image_tags: list[string]
    image_size_in_bytes: integer
    image_pushed_at: datetime
    image_scan_status: ImageScanStatus

- name: ImageFailure
  class:
    image_id: ImageId
    failure_code: string
    failure_reason: string

- name: ImageScanStatus
  class:
    status: string
    description: string

- name: ImageScanFinding
  class:
    name: string
    description: string
    uri: string
    severity: string
    attributes: list[ScanFindingAttribute]

- name: ScanFindingAttribute
  class:
    key: string
    value: string
