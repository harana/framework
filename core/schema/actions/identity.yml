- name: Authenticate User Credentials
  action: authenticate
  inputs:
    mfa_code: string
    password: string #required
    username: string #required
  outputs:
    access_token: string
    expires_at: datetime
    refresh_token: string
    success: boolean
    user_id: string

- name: Verify Access Token
  action: verify_token
  inputs:
    token: string #required
  outputs:
    claims: TokenClaims
    expires_at: datetime
    user_id: string
    valid: boolean

- name: Refresh Access Token
  action: refresh_token
  inputs:
    refresh_token: string #required
  outputs:
    access_token: string
    expires_at: datetime
    refresh_token: string

- name: Revoke Access Token
  action: revoke_token
  inputs:
    token: string #required
  outputs:
    success: boolean

- name: Get User By ID
  action: get_user
  inputs:
    user_id: string #required
  outputs:
    created_at: datetime
    email: string
    metadata: UserMetadata
    roles: list[string]
    user_id: string
    username: string

- name: Create New User
  action: create_user
  inputs:
    email: string #required
    metadata: UserMetadata
    password: string #required
    roles: list[string]
    username: string #required
  outputs:
    success: boolean
    user_id: string

- name: Update User Details
  action: update_user
  inputs:
    email: string
    metadata: UserMetadata
    roles: list[string]
    user_id: string #required
  outputs:
    success: boolean

- name: Delete User Account
  action: delete_user
  inputs:
    hard_delete: boolean = false
    user_id: string #required
  outputs:
    success: boolean

- name: Change User Password
  action: change_password
  inputs:
    current_password: string #required
    new_password: string #required
    user_id: string #required
  outputs:
    success: boolean

- name: Request Password Reset
  action: request_password_reset
  inputs:
    email: string #required
  outputs:
    reset_token: string
    success: boolean

- name: Reset Password With Token
  action: reset_password
  inputs:
    new_password: string #required
    reset_token: string #required
  outputs:
    success: boolean

- name: List Users
  action: list_users
  inputs:
    limit: integer = 100
    offset: integer = 0
    roles: list[string]
    search: string
  outputs:
    total: integer
    users: list[UserInfo]

- name: User
  class:
    user_id: string
    username: string
    email: string
    roles: list[string]
    metadata: UserMetadata
    created_at: datetime
    last_login: datetime

- name: TokenClaims
  class:
    claims: map[string, any]

- name: UserMetadata
  class:
    values: map[string, any]

- name: UserInfo
  class:
    user_id: string
    username: string
    email: string
    roles: list[string]
    created_at: datetime
