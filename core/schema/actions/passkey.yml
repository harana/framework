- name: Generate Registration Options
  action: generate_registration_options
  inputs:
    attestation: none | indirect | direct | enterprise = none
    authenticator_selection: PasskeyAuthenticatorSelection
    exclude_credentials: list[PasskeyCredentialDescriptor]
    relying_party_id: string #required
    relying_party_name: string #required
    timeout: integer = 60000
    user_display_name: string #required
    user_id: string #required
    user_name: string #required
  outputs:
    challenge: string
    options: PasskeyRegistrationOptions

- name: Verify Registration Response
  action: verify_registration
  inputs:
    expected_challenge: string #required
    expected_origin: string #required
    expected_rp_id: string #required
    require_user_verification: boolean = true
    response: PasskeyRegistrationResponse #required
  outputs:
    aaguid: string
    attestation_object: bytes
    counter: integer
    credential_backed_up: boolean
    credential_device_type: string
    credential_id: string
    credential_public_key: bytes
    verified: boolean

- name: Generate Authentication Options
  action: generate_authentication_options
  inputs:
    allow_credentials: list[PasskeyCredentialDescriptor]
    relying_party_id: string #required
    timeout: integer = 60000
    user_verification: required | preferred | discouraged = preferred
  outputs:
    challenge: string
    options: PasskeyAuthenticationOptions

- name: Verify Authentication Response
  action: verify_authentication
  inputs:
    credential_current_counter: integer #required
    credential_public_key: bytes #required
    expected_challenge: string #required
    expected_origin: string #required
    expected_rp_id: string #required
    require_user_verification: boolean = true
    response: PasskeyAuthenticationResponse #required
  outputs:
    credential_backed_up: boolean
    credential_device_type: string
    new_counter: integer
    verified: boolean

- name: Store Passkey Credential
  action: store_credential
  inputs:
    aaguid: string
    backed_up: boolean
    counter: integer #required
    credential_id: string #required
    credential_public_key: bytes #required
    device_type: string
    friendly_name: string
    transports: list[string]
    user_id: string #required
  outputs:
    passkey_id: string
    success: boolean

- name: Get User Passkeys
  action: get_user_passkeys
  inputs:
    user_id: string #required
  outputs:
    count: integer
    passkeys: list[PasskeyInfo]

- name: Get Passkey By Credential ID
  action: get_passkey
  inputs:
    credential_id: string #required
  outputs:
    backed_up: boolean
    counter: integer
    created_at: datetime
    credential_id: string
    credential_public_key: bytes
    device_type: string
    friendly_name: string
    last_used_at: datetime
    passkey_id: string
    transports: list[string]
    user_id: string

- name: Update Passkey Counter
  action: update_counter
  inputs:
    credential_id: string #required
    new_counter: integer #required
  outputs:
    success: boolean

- name: Delete Passkey
  action: delete_passkey
  inputs:
    passkey_id: string #required
    user_id: string #required
  outputs:
    success: boolean

- name: Update Passkey Name
  action: update_passkey_name
  inputs:
    friendly_name: string #required
    passkey_id: string #required
  outputs:
    success: boolean

- name: Check Passkey Support
  action: check_support
  inputs:
    user_agent: string #required
  outputs:
    conditional_mediation: boolean
    platform_authenticator: boolean
    user_verifying_platform_authenticator: boolean

- name: Passkey
  class:
    passkey_id: string
    credential_id: string
    user_id: string
    credential_public_key: bytes
    counter: integer
    device_type: string
    backed_up: boolean
    friendly_name: string
    created_at: datetime
    last_used_at: datetime

- name: PasskeyAuthenticatorSelection
  class:
    authenticator_attachment: string
    resident_key: string
    require_resident_key: boolean
    user_verification: string

- name: PasskeyCredentialDescriptor
  class:
    id: string
    type: string
    transports: list[string]

- name: PasskeyRegistrationOptions
  class:
    rp: PasskeyRelyingParty
    user: PasskeyUser
    challenge: string
    pub_key_cred_params: list[PasskeyCredParam]
    timeout: integer
    attestation: string

- name: PasskeyRelyingParty
  class:
    id: string
    name: string

- name: PasskeyUser
  class:
    id: string
    name: string
    display_name: string

- name: PasskeyCredParam
  class:
    type: string
    alg: integer

- name: PasskeyRegistrationResponse
  class:
    id: string
    raw_id: string
    response: PasskeyAuthenticatorAttestationResponse
    type: string

- name: PasskeyAuthenticatorAttestationResponse
  class:
    client_data_json: string
    attestation_object: string

- name: PasskeyAuthenticationOptions
  class:
    challenge: string
    timeout: integer
    rp_id: string
    allow_credentials: list[PasskeyCredentialDescriptor]
    user_verification: string

- name: PasskeyAuthenticationResponse
  class:
    id: string
    raw_id: string
    response: PasskeyAuthenticatorAssertionResponse
    type: string

- name: PasskeyAuthenticatorAssertionResponse
  class:
    client_data_json: string
    authenticator_data: string
    signature: string
    user_handle: string

- name: PasskeyInfo
  class:
    passkey_id: string
    credential_id: string
    friendly_name: string
    device_type: string
    created_at: datetime
    last_used_at: datetime
