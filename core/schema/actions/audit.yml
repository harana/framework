- name: Log Audit Event
  action: log_event
  inputs:
    action: string #required
    actor_id: string #required
    actor_type: user | service | system = user
    details: map[string, any]
    ip_address: string
    metadata: map[string, any]
    outcome: success | failure | partial #required
    resource_id: string #required
    resource_type: string #required
    user_agent: string
  outputs:
    audit_id: string
    success: boolean
    timestamp: datetime

- name: Query Audit Logs
  action: query_logs
  inputs:
    action: string
    actor_id: string
    actor_type: user | service | system
    end_time: datetime
    limit: integer = 100
    offset: integer = 0
    outcome: success | failure | partial
    resource_id: string
    resource_type: string
    sort_order: asc | desc = desc
    start_time: datetime #required
  outputs:
    has_more: boolean
    logs: list[AuditEvent]
    total: integer

- name: Get Audit Event By ID
  action: get_event
  inputs:
    audit_id: string #required
  outputs:
    action: string
    actor_id: string
    actor_type: string
    audit_id: string
    details: map[string, any]
    ip_address: string
    metadata: map[string, any]
    outcome: string
    resource_id: string
    resource_type: string
    timestamp: datetime
    user_agent: string

- name: Get Actor Activity
  action: get_actor_activity
  inputs:
    actor_id: string #required
    end_time: datetime
    limit: integer = 100
    start_time: datetime
  outputs:
    activities: list[AuditActivity]
    first_activity: datetime
    last_activity: datetime
    total: integer

- name: Get Resource History
  action: get_resource_history
  inputs:
    end_time: datetime
    limit: integer = 100
    resource_id: string #required
    resource_type: string #required
    start_time: datetime
  outputs:
    created_at: datetime
    history: list[AuditEvent]
    last_modified: datetime
    total: integer

- name: Export Audit Logs
  action: export_logs
  inputs:
    end_time: datetime #required
    filters: AuditFilter
    format: json | csv | parquet = json
    include_fields: list[string]
    start_time: datetime #required
  outputs:
    download_url: string
    expires_at: datetime
    export_id: string
    file_size: integer
    record_count: integer

- name: Create Audit Alert
  action: create_alert
  inputs:
    conditions: AuditAlertCondition #required
    description: string
    enabled: boolean = true
    name: string #required
    notification_channels: list[string] #required
  outputs:
    alert_id: string
    success: boolean

- name: Delete Audit Alert
  action: delete_alert
  inputs:
    alert_id: string #required
  outputs:
    success: boolean

- name: List Audit Alerts
  action: list_alerts
  inputs:
    enabled: boolean
    limit: integer = 100
  outputs:
    alerts: list[AuditAlert]
    total: integer

- name: Get Audit Statistics
  action: get_statistics
  inputs:
    end_time: datetime #required
    group_by: action | resource_type | actor_id | outcome | hour | day = day
    start_time: datetime #required
  outputs:
    statistics: list[AuditStatistic]
    total_events: integer
    unique_actors: integer
    unique_resources: integer

- name: Set Retention Policy
  action: set_retention_policy
  inputs:
    archive_to_cold_storage: boolean = false
    cold_storage_after_days: integer
    retention_days: integer #required
  outputs:
    policy_id: string
    success: boolean

- name: Get Retention Policy
  action: get_retention_policy
  inputs: {}
  outputs:
    archive_to_cold_storage: boolean
    cold_storage_after_days: integer
    policy_id: string
    retention_days: integer

- name: Verify Audit Log Integrity
  action: verify_integrity
  inputs:
    end_time: datetime #required
    start_time: datetime #required
  outputs:
    tampered_records: integer
    total_records: integer
    verification_hash: string
    verified: boolean

- name: AuditEvent
  class:
    audit_id: string
    action: string
    actor_id: string
    actor_type: string
    resource_id: string
    resource_type: string
    outcome: string
    timestamp: datetime
    ip_address: string
    user_agent: string
    details: map[string, any]
    metadata: map[string, any]

- name: AuditActivity
  class:
    audit_id: string
    action: string
    resource_id: string
    resource_type: string
    outcome: string
    timestamp: datetime

- name: AuditFilter
  class:
    action: string
    actor_id: string
    actor_type: string
    outcome: string
    resource_type: string

- name: AuditAlertCondition
  class:
    field: string
    operator: string
    value: string

- name: AuditAlert
  class:
    alert_id: string
    name: string
    description: string
    conditions: AuditAlertCondition
    enabled: boolean
    notification_channels: list[string]

- name: AuditStatistic
  class:
    key: string
    count: integer
    percentage: float
