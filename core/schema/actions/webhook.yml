- name: Register Webhook Endpoint
  action: register
  inputs:
    active: boolean = true
    description: string
    events: list[string] #required
    secret: string
    url: string #required
  outputs:
    secret: string
    success: boolean
    webhook_id: string

- name: Update Webhook Configuration
  action: update
  inputs:
    active: boolean
    description: string
    events: list[string]
    secret: string
    url: string
    webhook_id: string #required
  outputs:
    success: boolean

- name: Unregister Webhook Endpoint
  action: unregister
  inputs:
    webhook_id: string #required
  outputs:
    success: boolean

- name: Trigger Webhook Event
  action: trigger
  inputs:
    event: string #required
    payload: any #required
    webhook_ids: list[string]
  outputs:
    success: boolean
    triggered_count: integer

- name: Get Webhook Details
  action: get
  inputs:
    webhook_id: string #required
  outputs:
    active: boolean
    created_at: datetime
    description: string
    events: list[string]
    url: string

- name: List Registered Webhooks
  action: lists
  inputs:
    active_only: boolean = false
    event: string
    limit: integer = 100
    offset: integer = 0
  outputs:
    total: integer
    webhooks: list[Webhook]

- name: Test Webhook Endpoint
  action: test
  inputs:
    payload: any
    webhook_id: string #required
  outputs:
    error: string
    response_time_ms: integer
    status_code: integer
    success: boolean

- name: Get Webhook Delivery Log
  action: get_deliveries
  inputs:
    limit: integer = 50
    offset: integer = 0
    status: success | failed | pending
    webhook_id: string #required
  outputs:
    deliveries: list[WebhookDelivery]
    total: integer

- name: Retry Failed Delivery
  action: retry_delivery
  inputs:
    delivery_id: string #required
  outputs:
    status_code: integer
    success: boolean

- name: Verify Webhook Signature
  action: verify_signature
  inputs:
    algorithm: sha256 | sha512 = sha256
    payload: string #required
    secret: string #required
    signature: string #required
  outputs:
    valid: boolean

- name: Rotate Webhook Secret
  action: rotate_secret
  inputs:
    webhook_id: string #required
  outputs:
    new_secret: string
    success: boolean

- name: Webhook
  class:
    webhook_id: string
    url: string
    events: list[string]
    secret: string
    active: boolean
    description: string
    created_at: datetime

- name: WebhookDelivery
  class:
    delivery_id: string
    webhook_id: string
    event: string
    status: string
    status_code: integer
    response_time_ms: integer
    error: string
    created_at: datetime
