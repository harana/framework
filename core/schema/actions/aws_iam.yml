- name: Create IAM User
  action: create_user
  inputs:
    path: string = /
    permissions_boundary: string
    tags: IamTags
    user_name: string #required
  outputs:
    arn: string
    create_date: datetime
    success: boolean
    user_id: string
    user_name: string

- name: Delete IAM User
  action: delete_user
  inputs:
    user_name: string #required
  outputs:
    success: boolean

- name: Get IAM User
  action: get_user
  inputs:
    user_name: string
  outputs:
    arn: string
    create_date: datetime
    password_last_used: datetime
    path: string
    permissions_boundary: PermissionsBoundary
    tags: list[IamTag]
    user_id: string
    user_name: string

- name: List IAM Users
  action: list_users
  inputs:
    max_items: integer = 100
    path_prefix: string = /
  outputs:
    is_truncated: boolean
    marker: string
    users: list[IamUser]

- name: Update IAM User
  action: update_user
  inputs:
    new_path: string
    new_user_name: string
    user_name: string #required
  outputs:
    success: boolean

- name: Create IAM Group
  action: create_group
  inputs:
    group_name: string #required
    path: string = /
  outputs:
    arn: string
    create_date: datetime
    group_id: string
    group_name: string
    success: boolean

- name: Delete IAM Group
  action: delete_group
  inputs:
    group_name: string #required
  outputs:
    success: boolean

- name: List IAM Groups
  action: list_groups
  inputs:
    max_items: integer = 100
    path_prefix: string = /
  outputs:
    groups: list[IamGroup]
    is_truncated: boolean
    marker: string

- name: Add User To Group
  action: add_user_to_group
  inputs:
    group_name: string #required
    user_name: string #required
  outputs:
    success: boolean

- name: Remove User From Group
  action: remove_user_from_group
  inputs:
    group_name: string #required
    user_name: string #required
  outputs:
    success: boolean

- name: List Groups For User
  action: list_groups_for_user
  inputs:
    max_items: integer = 100
    user_name: string #required
  outputs:
    groups: list[IamGroup]
    is_truncated: boolean
    marker: string

- name: Create IAM Role
  action: create_role
  inputs:
    assume_role_policy_document: string #required
    description: string
    max_session_duration: integer = 3600
    path: string = /
    permissions_boundary: string
    role_name: string #required
    tags: IamTags
  outputs:
    arn: string
    create_date: datetime
    role_id: string
    role_name: string
    success: boolean

- name: Delete IAM Role
  action: delete_role
  inputs:
    role_name: string #required
  outputs:
    success: boolean

- name: Get IAM Role
  action: get_role
  inputs:
    role_name: string #required
  outputs:
    arn: string
    assume_role_policy_document: string
    create_date: datetime
    description: string
    max_session_duration: integer
    path: string
    permissions_boundary: PermissionsBoundary
    role_id: string
    role_name: string
    tags: list[IamTag]

- name: List IAM Roles
  action: list_roles
  inputs:
    max_items: integer = 100
    path_prefix: string = /
  outputs:
    is_truncated: boolean
    marker: string
    roles: list[IamRole]

- name: Create IAM Policy
  action: create_policy
  inputs:
    description: string
    path: string = /
    policy_document: string #required
    policy_name: string #required
    tags: IamTags
  outputs:
    arn: string
    create_date: datetime
    policy_id: string
    policy_name: string
    success: boolean

- name: Delete IAM Policy
  action: delete_policy
  inputs:
    policy_arn: string #required
  outputs:
    success: boolean

- name: Get IAM Policy
  action: get_policy
  inputs:
    policy_arn: string #required
  outputs:
    arn: string
    attachment_count: integer
    create_date: datetime
    default_version_id: string
    description: string
    is_attachable: boolean
    path: string
    permissions_boundary_usage_count: integer
    policy_id: string
    policy_name: string
    tags: list[IamTag]
    update_date: datetime

- name: List IAM Policies
  action: list_policies
  inputs:
    max_items: integer = 100
    only_attached: boolean = false
    path_prefix: string = /
    scope: All | AWS | Local = All
  outputs:
    is_truncated: boolean
    marker: string
    policies: list[IamPolicy]

- name: Attach User Policy
  action: attach_user_policy
  inputs:
    policy_arn: string #required
    user_name: string #required
  outputs:
    success: boolean

- name: Detach User Policy
  action: detach_user_policy
  inputs:
    policy_arn: string #required
    user_name: string #required
  outputs:
    success: boolean

- name: Attach Group Policy
  action: attach_group_policy
  inputs:
    group_name: string #required
    policy_arn: string #required
  outputs:
    success: boolean

- name: Detach Group Policy
  action: detach_group_policy
  inputs:
    group_name: string #required
    policy_arn: string #required
  outputs:
    success: boolean

- name: Attach Role Policy
  action: attach_role_policy
  inputs:
    policy_arn: string #required
    role_name: string #required
  outputs:
    success: boolean

- name: Detach Role Policy
  action: detach_role_policy
  inputs:
    policy_arn: string #required
    role_name: string #required
  outputs:
    success: boolean

- name: Put User Policy
  action: put_user_policy
  inputs:
    policy_document: string #required
    policy_name: string #required
    user_name: string #required
  outputs:
    success: boolean

- name: Put Group Policy
  action: put_group_policy
  inputs:
    group_name: string #required
    policy_document: string #required
    policy_name: string #required
  outputs:
    success: boolean

- name: Put Role Policy
  action: put_role_policy
  inputs:
    policy_document: string #required
    policy_name: string #required
    role_name: string #required
  outputs:
    success: boolean

- name: Create Access Key
  action: create_access_key
  inputs:
    user_name: string
  outputs:
    access_key_id: string
    create_date: datetime
    secret_access_key: string
    status: string
    success: boolean

- name: Delete Access Key
  action: delete_access_key
  inputs:
    access_key_id: string #required
    user_name: string
  outputs:
    success: boolean

- name: List Access Keys
  action: list_access_keys
  inputs:
    max_items: integer = 100
    user_name: string
  outputs:
    access_key_metadata: list[AccessKeyMetadata]
    is_truncated: boolean
    marker: string

- name: Update Access Key
  action: update_access_key
  inputs:
    access_key_id: string #required
    status: Active | Inactive #required
    user_name: string
  outputs:
    success: boolean

- name: Get Account Summary
  action: get_account_summary
  inputs: {}
  outputs:
    summary_map: AccountSummary

- name: Generate Credential Report
  action: generate_credential_report
  inputs: {}
  outputs:
    state: string
    success: boolean

- name: Get Credential Report
  action: get_credential_report
  inputs: {}
  outputs:
    content: string
    generated_time: datetime
    report_format: string

- name: IamUser
  class:
    user_id: string
    user_name: string
    arn: string
    path: string
    create_date: datetime
    password_last_used: datetime
    permissions_boundary: PermissionsBoundary
    tags: list[IamTag]

- name: IamTags
  class:
    items: list[IamTag]

- name: IamTag
  class:
    key: string
    value: string

- name: PermissionsBoundary
  class:
    permissions_boundary_type: string
    permissions_boundary_arn: string

- name: IamGroup
  class:
    group_id: string
    group_name: string
    arn: string
    path: string
    create_date: datetime

- name: IamRole
  class:
    role_id: string
    role_name: string
    arn: string
    path: string
    create_date: datetime
    description: string
    max_session_duration: integer
    assume_role_policy_document: string

- name: IamPolicy
  class:
    policy_id: string
    policy_name: string
    arn: string
    path: string
    create_date: datetime
    update_date: datetime
    attachment_count: integer
    is_attachable: boolean

- name: AccessKeyMetadata
  class:
    access_key_id: string
    user_name: string
    status: string
    create_date: datetime

- name: AccountSummary
  class:
    users: integer
    groups: integer
    roles: integer
    policies: integer
    users_quota: integer
    groups_quota: integer
    roles_quota: integer
    policies_quota: integer
    server_certificates: integer
    mfa_devices: integer
    account_mfa_enabled: boolean
