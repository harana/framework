- name: Create Secret
  action: create
  inputs:
    description: string
    kms_key_id: string
    name: string #required
    secret_value: string #required
    tags: SecretsTags
  outputs:
    arn: string
    name: string
    success: boolean
    version_id: string

- name: Get Secret Value
  action: get_value
  inputs:
    secret_id: string #required
    version_id: string
    version_stage: string
  outputs:
    arn: string
    created_date: integer
    name: string
    secret_value: string
    version_id: string

- name: Update Secret
  action: update
  inputs:
    description: string
    kms_key_id: string
    secret_id: string #required
    secret_value: string #required
  outputs:
    arn: string
    name: string
    success: boolean
    version_id: string

- name: Delete Secret
  action: delete
  inputs:
    force_delete: boolean = false
    recovery_window_days: integer = 30
    secret_id: string #required
  outputs:
    arn: string
    deletion_date: integer
    name: string
    success: boolean

- name: Restore Secret
  action: restore
  inputs:
    secret_id: string #required
  outputs:
    arn: string
    name: string
    success: boolean

- name: List Secrets
  action: lists
  inputs:
    filters: list[SecretFilter]
    max_results: integer = 100
    sort_order: asc | desc = asc
  outputs:
    next_token: string
    secrets: list[SecretListEntry]

- name: Describe Secret
  action: describe
  inputs:
    secret_id: string #required
  outputs:
    arn: string
    description: string
    kms_key_id: string
    last_changed_date: integer
    last_rotated_date: integer
    name: string
    rotation_enabled: boolean
    tags: SecretsTags

- name: Put Secret Value
  action: put_value
  inputs:
    secret_id: string #required
    secret_value: string #required
    version_stages: list[string]
  outputs:
    arn: string
    name: string
    version_id: string
    version_stages: list[string]

- name: Rotate Secret
  action: rotate
  inputs:
    rotation_lambda_arn: string #required
    rotation_rules: RotationRules
    secret_id: string #required
  outputs:
    arn: string
    name: string
    success: boolean
    version_id: string

- name: Cancel Rotate Secret
  action: cancel_rotate
  inputs:
    secret_id: string #required
    version_id: string #required
  outputs:
    arn: string
    name: string
    success: boolean
    version_id: string

- name: Tag Secret
  action: tag
  inputs:
    secret_id: string #required
    tags: SecretsTags #required
  outputs:
    success: boolean

- name: Untag Secret
  action: untag
  inputs:
    secret_id: string #required
    tag_keys: list[string] #required
  outputs:
    success: boolean

- name: Replicate Secret
  action: replicate
  inputs:
    kms_key_ids: KmsKeyIds
    regions: list[string] #required
    secret_id: string #required
  outputs:
    arn: string
    replication_status: list[ReplicationStatus]
    success: boolean

- name: Remove Regions From Replication
  action: remove_regions_from_replication
  inputs:
    regions: list[string] #required
    secret_id: string #required
  outputs:
    arn: string
    replication_status: list[ReplicationStatus]
    success: boolean

- name: Validate Secret
  action: validate
  inputs:
    secret_id: string #required
  outputs:
    exists: boolean
    scheduled_for_deletion: boolean
    valid: boolean

- name: AwsSecret
  class:
    arn: string
    name: string
    description: string
    secret_value: string
    version_id: string
    kms_key_id: string
    rotation_enabled: boolean
    last_changed_date: datetime
    last_rotated_date: datetime

- name: SecretsTags
  class:
    items: list[SecretsTag]

- name: SecretsTag
  class:
    key: string
    value: string

- name: SecretFilter
  class:
    key: string
    values: list[string]

- name: SecretListEntry
  class:
    arn: string
    name: string
    description: string
    kms_key_id: string
    rotation_enabled: boolean
    last_accessed_date: datetime
    last_changed_date: datetime
    tags: list[SecretsTag]

- name: RotationRules
  class:
    automatically_after_days: integer
    duration: string
    schedule_expression: string

- name: KmsKeyIds
  class:
    regions: map[string, string]

- name: ReplicationStatus
  class:
    region: string
    kms_key_id: string
    status: string
    status_message: string
    last_accessed_date: datetime
