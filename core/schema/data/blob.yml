- name: Blob Storage
  class: blob_storage
  id: [name]
  schema:
    - access_key_id: string? #max(255)
    - allowed_mime_types: string? # comma-separated
    - base_path: string? #max(1000)
    - bucket: string? #max(255)
    - created_at: datetime = now()
    - endpoint: string? #url
    - is_active: bool = true
    - max_file_size: int = 104857600 #min(1) # 100MB default
    - provider: s3 | azure | gcs | local | minio = local
    - region: string? #max(100)
    - secret_access_key: string? #max(255)
    - updated_at: datetime = now()

- name: Blob Object
  class: blob_object
  id: [storage_id, key]
  schema:
    - cdn_url: string? #url
    - content_hash: string? #max(128) # MD5, SHA256, etc.
    - created_at: datetime = now()
    - expires_at: datetime?
    - file_name: string #required #max(255)
    - file_size: int #required #min(1)
    - is_encrypted: bool = false
    - is_public: bool = false
    - key: string #required #max(1000)
    - metadata: string? # JSON metadata
    - mime_type: string #required #max(100)
    - storage_id: id #required -> BlobStorage.id
    - updated_at: datetime = now()
    - uploaded_by: id? -> User.id
    - url: string? #url
    - version: string? #max(100)

- name: Blob Access Log
  class: blob_access_log
  id: [object_id, accessed_at, accessed_by]
  schema:
    - accessed_at: datetime = now()
    - accessed_by: id? -> User.id
    - action: upload | download | delete | view | copy | move = view
    - bytes_transferred: int? #min(0)
    - ip_address: string? #max(45)
    - object_id: id #required -> BlobObject.id
    - status: success | failed | unauthorized = success
    - user_agent: string? #max(500)

- name: Blob Multipart Upload
  class: blob_multipart_upload
  id: [upload_id]
  schema:
    - completed_at: datetime?
    - completed_parts: int = 0 #min(0)
    - created_at: datetime = now()
    - expires_at: datetime?
    - file_name: string #required #max(255)
    - key: string #required #max(1000)
    - status: initiated | in_progress | completed | aborted | failed = initiated
    - storage_id: id #required -> BlobStorage.id
    - total_parts: int #required #min(1)
    - total_size: int? #min(0)
    - updated_at: datetime = now()
    - upload_id: string #required #unique #max(255)
    - uploaded_by: id? -> User.id
