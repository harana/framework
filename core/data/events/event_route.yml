
- name: HTTP Response Sent
  class: event_route_response_sent
  extends: event
  schema:
    event_route: bool
    http_method: string #required
  set:
    attributes: $all_values
    type: route.response.sent

- name: Route Matched
  class: event_route_matched
  extends: event
  schema:
    handler: string #required
    matched_at: datetime = now()
    path_params: string?
    request_id: id #required
    route_name: string?
    route_pattern: string #required
  set:
    attributes: $all_values
    type: route.matched

- name: Route Not Found
  class: event_route_not_found
  extends: event
  schema:
    method: GET | POST | PUT | PATCH | DELETE | HEAD | OPTIONS
    occurred_at: datetime = now()
    path: string #required
    request_id: id #required
  set:
    attributes: $all_values
    type: route.not_found

- name: Request Authenticated
  class: event_route_request_authenticated
  extends: event
  schema:
    auth_method: bearer | basic | api_key | session | none = none
    authenticated_at: datetime = now()
    is_authenticated: bool = false
    request_id: id #required
    user_id: id?
  set:
    attributes: $all_values
    type: route.request.authenticated

- name: Request Rate Limited
  class: event_route_request_rate_limited
  extends: event
  schema:
    current_count: int #required #min(0)
    ip_address: string? #ip
    limit: int #required #min(1)
    limited_at: datetime = now()
    request_id: id #required
    user_id: id?
    window_seconds: int #required #min(1)
  set:
    attributes: $all_values
    type: route.request.rate_limited
