- action: create_bucket
  inputs:
    acl: private | public-read | public-read-write | authenticated-read = private
    bucket: string
    region: string
    tags: s3_tags
  outputs:
    bucket: string
    location: string
    success: boolean

- action: delete_bucket
  inputs:
    bucket: string
    region: string
  outputs:
    success: boolean

- action: list_buckets
  inputs:
    region: string
  outputs:
    buckets: list[s3_bucket]

- action: put_object
  inputs:
    acl: private | public-read | public-read-write | authenticated-read
    bucket: string
    content: bytes
    content_type: string
    key: string
    metadata: object_metadata
    region: string
    server_side_encryption: aes256 | aws:kms
    storage_class: standard | REDUCED_REDUNDANCY | STANDARD_IA | ONEZONE_IA | INTELLIGENT_TIERING | glacier | DEEP_ARCHIVE
    tags: s3_tags
  outputs:
    etag: string
    success: boolean
    version_id: string

- action: get_object
  inputs:
    bucket: string
    key: string
    region: string
    version_id: string
  outputs:
    content: bytes
    content_type: string
    etag: string
    last_modified: date
    metadata: object_metadata
    size: int
    storage_class: string
    version_id: string

- action: delete_object
  inputs:
    bucket: string
    key: string
    region: string
    version_id: string
  outputs:
    success: boolean
    version_id: string

- action: delete_objects
  inputs:
    bucket: string
    keys: list[string]
    region: string
  outputs:
    deleted: list[deleted_object]
    errors: list[s3_error]
    success: boolean

- action: list_objects
  inputs:
    bucket: string
    continuation_token: string
    delimiter: string
    max_keys: int = 1000
    prefix: string
    region: string
    start_after: string
  outputs:
    contents: list[s3_object]
    continuation_token: string
    is_truncated: boolean
    key_count: int
    next_continuation_token: string
    prefix: string

- action: copy_object
  inputs:
    destination_bucket: string
    destination_key: string
    metadata: object_metadata
    metadata_directive: copy | replace = copy
    region: string
    source_bucket: string
    source_key: string
    source_version_id: string
    storage_class: string
    tags: s3_tags
  outputs:
    etag: string
    success: boolean
    version_id: string

- action: head_object
  inputs:
    bucket: string
    key: string
    region: string
    version_id: string
  outputs:
    content_length: int
    content_type: string
    etag: string
    exists: boolean
    last_modified: date
    metadata: object_metadata
    storage_class: string
    version_id: string

- action: get_presigned_url
  inputs:
    bucket: string
    expires_in: int = 3600
    key: string
    operation: get_object | put_object = get_object
    region: string
  outputs:
    expires_at: date
    url: string

- action: put_bucket_policy
  inputs:
    bucket: string
    policy: string
    region: string
  outputs:
    success: boolean

- action: get_bucket_policy
  inputs:
    bucket: string
    region: string
  outputs:
    policy: string

- action: delete_bucket_policy
  inputs:
    bucket: string
    region: string
  outputs:
    success: boolean

- action: put_bucket_versioning
  inputs:
    bucket: string
    region: string
    status: enabled | suspended
  outputs:
    success: boolean

- action: get_bucket_versioning
  inputs:
    bucket: string
    region: string
  outputs:
    mfa_delete: string
    status: string

- action: put_bucket_encryption
  inputs:
    bucket: string
    kms_master_key_id: string
    region: string
    sse_algorithm: aes256 | aws:kms
  outputs:
    success: boolean

- action: get_bucket_encryption
  inputs:
    bucket: string
    region: string
  outputs:
    rules: list[encryption_rule]

- action: put_bucket_cors
  inputs:
    bucket: string
    cors_rules: list[cors_rule]
    region: string
  outputs:
    success: boolean

- action: get_bucket_cors
  inputs:
    bucket: string
    region: string
  outputs:
    cors_rules: list[cors_rule]

- action: delete_bucket_cors
  inputs:
    bucket: string
    region: string
  outputs:
    success: boolean

- action: put_bucket_lifecycle
  inputs:
    bucket: string
    lifecycle_rules: list[lifecycle_rule]
    region: string
  outputs:
    success: boolean

- action: get_bucket_lifecycle
  inputs:
    bucket: string
    region: string
  outputs:
    rules: list[lifecycle_rule]

- action: put_object_tagging
  inputs:
    bucket: string
    key: string
    region: string
    tags: s3_tags
    version_id: string
  outputs:
    success: boolean
    version_id: string

- action: get_object_tagging
  inputs:
    bucket: string
    key: string
    region: string
    version_id: string
  outputs:
    tags: s3_tags
    version_id: string

- action: create_multipart_upload
  inputs:
    bucket: string
    content_type: string
    key: string
    metadata: object_metadata
    region: string
    storage_class: string
  outputs:
    success: boolean
    upload_id: string

- action: upload_part
  inputs:
    body: bytes
    bucket: string
    key: string
    part_number: int
    region: string
    upload_id: string
  outputs:
    etag: string
    success: boolean

- action: complete_multipart_upload
  inputs:
    bucket: string
    key: string
    parts: list[completed_part]
    region: string
    upload_id: string
  outputs:
    bucket: string
    etag: string
    key: string
    location: string
    success: boolean

- action: abort_multipart_upload
  inputs:
    bucket: string
    key: string
    region: string
    upload_id: string
  outputs:
    success: boolean

- object: bucket
  id: [account_id, bucket_name]
  schema:
    - account_id: string #max(20)
    - acl: private | public_read | public_read_write | authenticated_read = private
    - bucket_name: string #unique #max(63)
    - cors_enabled: boolean = false
    - created_at: date = now()
    - encryption_algorithm: none | aes256 | aws_kms = none
    - is_versioned: boolean = false
    - kms_key_id: string? #max(255)
    - lifecycle_rules_count: int = 0 #min(0)
    - location: string? #max(100)
    - region: string? #max(50)
    - tags: string? # json
    - updated_at: date = now()

- object: object
  id: [bucket_id, key]
  schema:
    - bucket_id: id -> aws_s3_bucket.id
    - content_type: string? #max(255)
    - created_at: date = now()
    - etag: string? #max(255)
    - is_delete_marker: boolean = false
    - key: string #max(1024)
    - last_modified: date?
    - metadata: string? # json
    - size: int? #min(0)
    - storage_class: standard | reduced_redundancy | standard_ia | onezone_ia | intelligent_tiering | glacier | deep_archive = standard
    - tags: string? # json
    - updated_at: date = now()
    - version_id: string? #max(255)

- object: bucket_policy
  id: [bucket_id]
  schema:
    - bucket_id: id -> aws_s3_bucket.id
    - created_at: date = now()
    - policy_document: string
    - updated_at: date = now()

- object: multipart_upload
  id: [bucket_id, key, upload_id]
  schema:
    - bucket_id: id -> aws_s3_bucket.id
    - completed_at: date?
    - content_type: string? #max(255)
    - created_at: date = now()
    - key: string #max(1024)
    - metadata: string? # json
    - status: initiated | in_progress | completed | aborted = initiated
    - storage_class: string? #max(50)
    - upload_id: string #unique #max(255)