- action: authenticate
  inputs:
    mfa_code: string
    password: string
    username: string
  outputs:
    access_token: string
    expires_at: date
    refresh_token: string
    success: boolean
    user_id: string

- action: verify_token
  inputs:
    token: string
  outputs:
    claims: token_claims
    expires_at: date
    user_id: string
    valid: boolean

- action: refresh_token
  inputs:
    refresh_token: string
  outputs:
    access_token: string
    expires_at: date
    refresh_token: string

- action: revoke_token
  inputs:
    token: string
  outputs:
    success: boolean

- action: get_user
  inputs:
    user_id: string
  outputs:
    created_at: date
    email: string
    metadata: user_metadata
    roles: list[string]
    user_id: string
    username: string

- action: create_user
  inputs:
    email: string
    metadata: user_metadata
    password: string
    roles: list[string]
    username: string
  outputs:
    success: boolean
    user_id: string

- action: update_user
  inputs:
    email: string
    metadata: user_metadata
    roles: list[string]
    user_id: string
  outputs:
    success: boolean

- action: delete_user
  inputs:
    hard_delete: boolean = false
    user_id: string
  outputs:
    success: boolean

- action: change_password
  inputs:
    current_password: string
    new_password: string
    user_id: string
  outputs:
    success: boolean

- action: request_password_reset
  inputs:
    email: string
  outputs:
    reset_token: string
    success: boolean

- action: reset_password
  inputs:
    new_password: string
    reset_token: string
  outputs:
    success: boolean

- action: list_users
  inputs:
    limit: int = 100
    offset: int = 0
    roles: list[string]
    search: string
  outputs:
    total: int
    users: list[user_info]

- object: user
  class:
    user_id: string
    username: string
    email: string
    roles: list[string]
    metadata: user_metadata
    created_at: date
    last_login: date

- object: token_claims
  class:
    claims: map[string, any]

- object: user_metadata
  class:
    values: map[string, any]

- object: user_info
  class:
    user_id: string
    username: string
    email: string
    roles: list[string]
    created_at: date

- object: group
  id: [id]
  schema:
    - created_at: date = now()
    - description: string? #max(500)
    - id: id
    - is_active: boolean = true

    - name: string #unique #max(100)
    - parent_id: id? -> group.id
    - updated_at: date = now()

- object: group_member
  id: [group_id, user_id]
  schema:
    - added_at: date = now()
    - added_by: id? -> user.id
    - group_id: id -> group.id
    - is_admin: boolean = false
    - user_id: id -> user.id

- object: group_role
  id: [group_id, role_id]
  schema:
    - assigned_at: date = now()
    - assigned_by: id? -> user.id
    - group_id: id -> group.id
    - role_id: id -> role.id

- object: role
  id: [id]
  schema:
    - created_at: date = now()
    - description: string? #max(500)
    - id: id
    - is_system: boolean = false

    - name: string #unique #max(100)
    - updated_at: date = now()

- object: role_permission
  id: [role_id, permission_id]
  schema:
    - granted_at: date = now()
    - granted_by: id? -> user.id
    - permission_id: id -> permission.id
    - role_id: id -> role.id

- object: user_role
  id: [user_id, role_id]
  schema:
    - assigned_at: date = now()
    - assigned_by: id? -> user.id
    - expires_at: date?
    - role_id: id -> role.id
    - user_id: id -> user.id

- object: user
  id: [id]
  schema:
    - avatar_url: string? #url
    - created_at: date = now()
    - email: string #unique #email #max(255)
    - first_name: string? #max(100)
    - id: id
    - is_active: boolean = true
    - is_verified: boolean = false
    - last_login_at: date?
    - last_name: string? #max(100)
    - phone: string? #max(20)
    - timezone: string? #max(50)
    - updated_at: date = now()
    - username: string #unique #max(50)

- object: user_profile
  id: [user_id]
  schema:
    - bio: string? #max(1000)
    - date_of_birth: date?
    - job_title: string? #max(100)
    - location: string? #max(200)
    - organisation: string? #max(200)
    - updated_at: date = now()
    - user_id: id -> user.id
    - website: string? #url

- object: user_credential
  id: [user_id, credential_type]
  schema:
    - created_at: date = now()
    - credential_type: password | passkey | oauth | api_key = password
    - credential_value: string #max(500)
    - is_primary: boolean = false
    - updated_at: date = now()
    - user_id: id -> user.id

- object: token_claims
  schema:
    - claims: map[string, any]

- object: user_metadata
  schema:
    - values: map[string, any]

- object: user_info
  schema:
    - user_id: string
    - username: string
    - email: string
    - roles: list[string]
    - created_at: date
