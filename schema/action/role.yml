- action: create
  inputs:
    description: string
    name: string
    permissions: list[role_permission]
  outputs:
    role_id: string
    success: boolean

- action: update
  inputs:
    description: string
    name: string
    permissions: list[role_permission]
    role_id: string
  outputs:
    success: boolean

- action: delete
  inputs:
    role_id: string
  outputs:
    success: boolean

- action: list
  inputs:
    limit: int = 100
    offset: int = 0
  outputs:
    roles: list[role_info]
    total: int

- action: get
  inputs:
    role_id: string
  outputs:
    description: string
    name: string
    permissions: list[role_permission]
    user_count: int

- action: check_permission
  inputs:
    method: string
    resource: string
    role_id: string
  outputs:
    allowed: boolean

- action: add_permission
  inputs:
    method: string
    conditions: role_permission_conditions
    resource: string
    role_id: string
  outputs:
    success: boolean

- action: remove_permission
  inputs:
    method: string
    resource: string
    role_id: string
  outputs:
    success: boolean

- action: clone
  inputs:
    new_name: string
    source_id: string
  outputs:
    role_id: string
    success: boolean

- object: role
  class:
    role_id: string
    name: string
    description: string
    permissions: list[role_permission]
    user_count: int
    created_at: date

- object: permission
  class:
    method: string
    resource: string
    conditions: role_permission_conditions

- object: info
  class:
    role_id: string
    name: string
    description: string
    user_count: int

- object: permission_conditions
  class:
    conditions: map[string, any]

- object: role
  schema:
    - created_at: date = now()
    - description: string? #max(500)
    - is_system: boolean = false

    - name: string #unique #max(200)
    - updated_at: date = now()

- object: permission
  id: [role_id, action, resource]
  schema:
    - action: string #max(100)
    - conditions: string? # json
    - granted_at: date = now()
    - granted_by: id? -> user.id
    - resource: string #max(200)
    - role_id: id -> role.id

- object: assignment
  id: [role_id, entity_id, entity_type]
  schema:
    - assigned_at: date = now()
    - assigned_by: id? -> user.id
    - entity_id: id
    - entity_type: user | group = user
    - expires_at: date?
    - role_id: id -> role.id

- object: info
  schema:
    - role_id: string

    - name: string
    - description: string
    - user_count: int

- object: permission_conditions
  schema:
    - conditions: map[string, any]
