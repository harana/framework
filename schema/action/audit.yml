- action: log_event
  inputs:
    method: string
    actor_id: string
    actor_type: user | service | system = user
    details: map[string, any]
    ip_address: string
    metadata: map[string, any]
    outcome: success | failure | partial
    resource_id: string
    resource_type: string
    user_agent: string
  outputs:
    audit_id: string
    success: boolean
    timestamp: date

- action: query_logs
  inputs:
    method: string
    actor_id: string
    actor_type: user | service | system
    end_time: date
    limit: int = 100
    offset: int = 0
    outcome: success | failure | partial
    resource_id: string
    resource_type: string
    sort_order: asc | desc = desc
    start_time: date
  outputs:
    has_more: boolean
    logs: list[audit_event]
    total: int

- action: get_event
  inputs:
    audit_id: string
  outputs:
    method: string
    actor_id: string
    actor_type: string
    audit_id: string
    details: map[string, any]
    ip_address: string
    metadata: map[string, any]
    outcome: string
    resource_id: string
    resource_type: string
    timestamp: date
    user_agent: string

- action: get_actor_activity
  inputs:
    actor_id: string
    end_time: date
    limit: int = 100
    start_time: date
  outputs:
    activities: list[audit_activity]
    first_activity: date
    last_activity: date
    total: int

- action: get_resource_history
  inputs:
    end_time: date
    limit: int = 100
    resource_id: string
    resource_type: string
    start_time: date
  outputs:
    created_at: date
    history: list[audit_event]
    last_modified: date
    total: int

- action: export_logs
  inputs:
    end_time: date
    filters: audit_filter
    format: json | csv | parquet = json
    include_fields: list[string]
    start_time: date
  outputs:
    download_url: string
    expires_at: date
    export_id: string
    file_size: int
    record_count: int

- action: create_alert
  inputs:
    conditions: audit_alert_condition
    description: string
    enabled: boolean = true
    name: string
    notification_channels: list[string]
  outputs:
    alert_id: string
    success: boolean

- action: delete_alert
  inputs:
    alert_id: string
  outputs:
    success: boolean

- action: list_alerts
  inputs:
    enabled: boolean
    limit: int = 100
  outputs:
    alerts: list[audit_alert]
    total: int

- action: get_statistics
  inputs:
    end_time: date
    group_by: action | resource_type | actor_id | outcome | hour | day = day
    start_time: date
  outputs:
    statistics: list[audit_statistic]
    total_events: int
    unique_actors: int
    unique_resources: int

- action: set_retention_policy
  inputs:
    archive_to_cold_storage: boolean = false
    cold_storage_after_days: int
    retention_days: int
  outputs:
    policy_id: string
    success: boolean

- action: get_retention_policy
  inputs: {}
  outputs:
    archive_to_cold_storage: boolean
    cold_storage_after_days: int
    policy_id: string
    retention_days: int

- action: verify_integrity
  inputs:
    end_time: date
    start_time: date
  outputs:
    tampered_records: int
    total_records: int
    verification_hash: string
    verified: boolean

- object: event
  class:
    audit_id: string
    method: string
    actor_id: string
    actor_type: string
    resource_id: string
    resource_type: string
    outcome: string
    timestamp: date
    ip_address: string
    user_agent: string
    details: map[string, any]
    metadata: map[string, any]

- object: activity
  class:
    audit_id: string
    method: string
    resource_id: string
    resource_type: string
    outcome: string
    timestamp: date

- object: filter
  class:
    method: string
    actor_id: string
    actor_type: string
    outcome: string
    resource_type: string

- object: alert_condition
  class:
    field: string
    operator: string
    value: string

- object: alert
  class:
    alert_id: string
    name: string
    description: string
    conditions: audit_alert_condition
    enabled: boolean
    notification_channels: list[string]

- object: statistic
  class:
    key: string
    count: int
    percentage: float

- object: event
  id: [actor_id, resource_id, created_at]
  schema:
    - action: string #max(200)
    - actor_id: string #max(200)
    - actor_type: user | service | system = user
    - created_at: date = now()
    - details: string?
    - ip_address: string? #max(45)
    - metadata: string?
    - outcome: success | failure | partial = success
    - resource_id: string #max(200)
    - resource_type: string #max(100)
    - user_agent: string? #max(500)

- object: alert
  schema:
    - action_pattern: string? #max(500)
    - actor_pattern: string? #max(500)
    - created_at: date = now()
    - description: string? #max(500)
    - is_active: boolean = true
    - last_triggered_at: date?
    - notification_channel: string? #max(100)
    - resource_pattern: string? #max(500)
    - updated_at: date = now()

- object: export
  id: [created_at]
  schema:
    - completed_at: date?
    - created_at: date = now()
    - download_url: string? #url
    - end_time: date
    - expires_at: date?
    - file_size: int? #min(0)
    - format: json | csv | parquet = json
    - record_count: int? #min(0)
    - start_time: date
    - status: pending | processing | completed | failed = pending

- object: activity
  schema:
    - audit_id: string
    - method: string
    - resource_id: string
    - resource_type: string
    - outcome: string
    - timestamp: date

- object: filter
  schema:
    - method: string
    - actor_id: string
    - actor_type: string
    - outcome: string
    - resource_type: string

- object: alert_condition
  schema:
    - field: string
    - operator: string
    - value: string

- object: statistic
  schema:
    - key: string
    - count: int
    - percentage: float
