- name: Log Audit Event
  action: log_event
  inputs:
    action: String #required
    actor_id: String #required
    actor_type: User | Service | System = User
    details: Map[String, Any]
    ip_address: String
    metadata: Map[String, Any]
    outcome: Success | Failure | Partial #required
    resource_id: String #required
    resource_type: String #required
    user_agent: String
  outputs:
    audit_id: String
    success: Boolean
    timestamp: Date

- name: Query Audit Logs
  action: query_logs
  inputs:
    action: String
    actor_id: String
    actor_type: User | Service | System
    end_time: Date
    limit: Int = 100
    offset: Int = 0
    outcome: Success | Failure | Partial
    resource_id: String
    resource_type: String
    sort_order: Asc | Desc = Desc
    start_time: Date #required
  outputs:
    has_more: Boolean
    logs: List[AuditEvent]
    total: Int

- name: Get Audit Event By ID
  action: get_event
  inputs:
    audit_id: String #required
  outputs:
    action: String
    actor_id: String
    actor_type: String
    audit_id: String
    details: Map[String, Any]
    ip_address: String
    metadata: Map[String, Any]
    outcome: String
    resource_id: String
    resource_type: String
    timestamp: Date
    user_agent: String

- name: Get Actor Activity
  action: get_actor_activity
  inputs:
    actor_id: String #required
    end_time: Date
    limit: Int = 100
    start_time: Date
  outputs:
    activities: List[AuditActivity]
    first_activity: Date
    last_activity: Date
    total: Int

- name: Get Resource History
  action: get_resource_history
  inputs:
    end_time: Date
    limit: Int = 100
    resource_id: String #required
    resource_type: String #required
    start_time: Date
  outputs:
    created_at: Date
    history: List[AuditEvent]
    last_modified: Date
    total: Int

- name: Export Audit Logs
  action: export_logs
  inputs:
    end_time: Date #required
    filters: AuditFilter
    format: Json | Csv | Parquet = Json
    include_fields: List[String]
    start_time: Date #required
  outputs:
    download_url: String
    expires_at: Date
    export_id: String
    file_size: Int
    record_count: Int

- name: Create Audit Alert
  action: create_alert
  inputs:
    conditions: AuditAlertCondition #required
    description: String
    enabled: Boolean = true
    name: String #required
    notification_channels: List[String] #required
  outputs:
    alert_id: String
    success: Boolean

- name: Delete Audit Alert
  action: delete_alert
  inputs:
    alert_id: String #required
  outputs:
    success: Boolean

- name: List Audit Alerts
  action: list_alerts
  inputs:
    enabled: Boolean
    limit: Int = 100
  outputs:
    alerts: List[AuditAlert]
    total: Int

- name: Get Audit Statistics
  action: get_statistics
  inputs:
    end_time: Date #required
    group_by: Action | ResourceType | ActorId | Outcome | Hour | Day = Day
    start_time: Date #required
  outputs:
    statistics: List[AuditStatistic]
    total_events: Int
    unique_actors: Int
    unique_resources: Int

- name: Set Retention Policy
  action: set_retention_policy
  inputs:
    archive_to_cold_storage: Boolean = false
    cold_storage_after_days: Int
    retention_days: Int #required
  outputs:
    policy_id: String
    success: Boolean

- name: Get Retention Policy
  action: get_retention_policy
  inputs: {}
  outputs:
    archive_to_cold_storage: Boolean
    cold_storage_after_days: Int
    policy_id: String
    retention_days: Int

- name: Verify Audit Log Integrity
  action: verify_integrity
  inputs:
    end_time: Date #required
    start_time: Date #required
  outputs:
    tampered_records: Int
    total_records: Int
    verification_hash: String
    verified: Boolean

- name: AuditEvent
  class:
    audit_id: String
    action: String
    actor_id: String
    actor_type: String
    resource_id: String
    resource_type: String
    outcome: String
    timestamp: Date
    ip_address: String
    user_agent: String
    details: Map[String, Any]
    metadata: Map[String, Any]

- name: AuditActivity
  class:
    audit_id: String
    action: String
    resource_id: String
    resource_type: String
    outcome: String
    timestamp: Date

- name: AuditFilter
  class:
    action: String
    actor_id: String
    actor_type: String
    outcome: String
    resource_type: String

- name: AuditAlertCondition
  class:
    field: String
    operator: String
    value: String

- name: AuditAlert
  class:
    alert_id: String
    name: String
    description: String
    conditions: AuditAlertCondition
    enabled: Boolean
    notification_channels: List[String]

- name: AuditStatistic
  class:
    key: String
    count: Int
    percentage: Float
