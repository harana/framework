- action: get_secret
  inputs:
    name: string
    version: string
  outputs:
    created_at: date
    value: string
    version: string

- action: set_secret
  inputs:
    description: string
    expires_at: date
    name: string
    value: string
  outputs:
    success: boolean
    version: string

- action: delete_secret
  inputs:
    force: boolean = false
    name: string
  outputs:
    success: boolean

- action: list_secrets
  inputs:
    limit: int = 100
    prefix: string
  outputs:
    secrets: list[secret_info]
    total: int

- action: rotate_secret
  inputs:
    name: string
    new_value: string
  outputs:
    new_version: string
    old_version: string
    success: boolean

- action: get_secret_metadata
  inputs:
    name: string
  outputs:
    created_at: date
    description: string
    expires_at: date
    updated_at: date
    version_count: int

- action: exists
  inputs:
    name: string
  outputs:
    exists: boolean

- action: list_secret_versions
  inputs:
    limit: int = 10
    name: string
  outputs:
    total: int
    versions: list[secret_version]

- action: restore_secret_version
  inputs:
    name: string
    version: string
  outputs:
    new_version: string
    success: boolean

- action: generate_secret
  inputs:
    charset: alphanumeric | hex | base64 = alphanumeric
    description: string
    length: int = 32
    name: string
  outputs:
    success: boolean
    value: string
    version: string

- object: secret
  class:
    name: string
    value: string
    version: string
    description: string
    created_at: date
    updated_at: date
    expires_at: date

- object: info
  class:
    name: string
    description: string
    created_at: date
    updated_at: date

- object: version
  class:
    version: string
    created_at: date
    is_current: boolean

- object: secret
  id: [key]
  schema:
    - created_at: date = now()
    - created_by: id? -> user.id
    - is_rotatable: boolean = false
    - key: string #unique #max(200)
    - last_rotated_at: date?
    - updated_at: date = now()
    - value: string #encrypted
    - version: int = 1 #min(1)

- object: version
  id: [secret_id, version]
  schema:
    - created_at: date = now()
    - created_by: id? -> user.id
    - is_active: boolean = true
    - secret_id: id -> secret.id
    - value: string #encrypted
    - version: int #min(1)

- object: access_log
  id: [secret_id, accessed_at, user_id]
  schema:
    - accessed_at: date = now()
    - method: read | write | rotate | delete = read
    - ip_address: string? #max(45)
    - secret_id: id -> secret.id
    - user_id: id? -> user.id

- object: info
  schema:
    - name: string
    - description: string
    - created_at: date
    - updated_at: date
