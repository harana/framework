- action: check_permission
  inputs:
    method: string
    resource: string
    user_id: string
  outputs:
    allowed: boolean
    reason: string

- action: grant_permission
  inputs:
    method: string
    conditions: user_permission_conditions
    expires_at: date
    resource: string
    user_id: string
  outputs:
    permission_id: string
    success: boolean

- action: revoke_permission
  inputs:
    permission_id: string
    user_id: string
  outputs:
    success: boolean

- action: list_permissions
  inputs:
    resource: string
    user_id: string
  outputs:
    permissions: list[user_permission_info]
    total: int

- action: assign_role
  inputs:
    role_id: string
    user_id: string
  outputs:
    success: boolean

- action: remove_role
  inputs:
    role_id: string
    user_id: string
  outputs:
    success: boolean

- action: list_roles
  inputs:
    user_id: string
  outputs:
    roles: list[user_role_info]
    total: int

- action: get_effective_permissions
  inputs:
    resource: string
    user_id: string
  outputs:
    permissions: list[effective_permission]
    sources: list[permission_source]

- object: user_permission
  class:
    permission_id: string
    user_id: string
    method: string
    resource: string
    conditions: user_permission_conditions
    expires_at: date

- object: user_permission_conditions
  class:
    conditions: map[string, any]

- object: user_permission_info
  class:
    permission_id: string
    method: string
    resource: string
    expires_at: date

- object: user_role_info
  class:
    role_id: string
    name: string
    assigned_at: date

- object: effective_permission
  class:
    method: string
    resource: string
    allowed: boolean

- object: permission_source
  class:
    source_type: string
    source_id: string
    name: string

- object: user_permission
  id: [user_id, resource, action]
  schema:
    - action: string #max(100)
    - conditions: string? # json
    - expires_at: date?
    - granted_at: date = now()
    - granted_by: id? -> user.id
    - resource: string #max(200)
    - user_id: id -> user.id

- object: effective_permission
  id: [user_id, resource, action]
  schema:
    - action: string #max(100)
    - allowed: boolean = false
    - resource: string #max(200)
    - source_id: string? #max(200)
    - source_type: direct | role | group | policy = direct
    - user_id: id -> user.id

- object: user_permission_conditions
  schema:
    - conditions: map[string, any]

- object: user_permission_info
  schema:
    - permission_id: string
    - method: string
    - resource: string
    - expires_at: date

- object: user_role_info
  schema:
    - role_id: string

    - name: string
    - assigned_at: date

- object: permission_source
  schema:
    - source_type: string
    - source_id: string

    - name: string
