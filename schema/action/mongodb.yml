- action: insert
  inputs:
    collection: string
    database: string
    document: mongo_document_data
  outputs:
    inserted_id: string
    success: boolean

- action: insert_many
  inputs:
    collection: string
    database: string
    documents: list[mongo_document_data]
    ordered: boolean = true
  outputs:
    inserted_count: int
    inserted_ids: list[string]
    success: boolean

- action: find_one
  inputs:
    collection: string
    database: string
    filter: mongo_filter
    projection: mongo_projection
  outputs:
    document: mongo_document_data
    found: boolean

- action: find
  inputs:
    collection: string
    database: string
    filter: mongo_filter = {}
    limit: int
    projection: mongo_projection
    skip: int = 0
    sort: mongo_sort
  outputs:
    count: int
    documents: list[mongo_document_data]

- action: update_one
  inputs:
    collection: string
    database: string
    filter: mongo_filter
    update: mongo_update
    upsert: boolean = false
  outputs:
    matched_count: int
    modified_count: int
    success: boolean
    upserted_id: string

- action: update_many
  inputs:
    collection: string
    database: string
    filter: mongo_filter
    update: mongo_update
    upsert: boolean = false
  outputs:
    matched_count: int
    modified_count: int
    success: boolean
    upserted_id: string

- action: replace_one
  inputs:
    collection: string
    database: string
    filter: mongo_filter
    replacement: mongo_document_data
    upsert: boolean = false
  outputs:
    matched_count: int
    modified_count: int
    success: boolean
    upserted_id: string

- action: delete_one
  inputs:
    collection: string
    database: string
    filter: mongo_filter
  outputs:
    deleted_count: int
    success: boolean

- action: delete_many
  inputs:
    collection: string
    database: string
    filter: mongo_filter
  outputs:
    deleted_count: int
    success: boolean

- action: count
  inputs:
    collection: string
    database: string
    filter: mongo_filter = {}
  outputs:
    count: int

- action: aggregate
  inputs:
    collection: string
    database: string
    pipeline: list[mongo_pipeline_stage]
  outputs:
    documents: list[mongo_document_data]

- action: create_index
  inputs:
    collection: string
    database: string
    keys: mongo_index_keys
    name: string
    unique: boolean = false
  outputs:
    index_name: string
    success: boolean

- action: drop_index
  inputs:
    collection: string
    database: string
    index_name: string
  outputs:
    success: boolean

- action: list_collections
  inputs:
    database: string
  outputs:
    collections: list[string]

- action: drop_collection
  inputs:
    collection: string
    database: string
  outputs:
    success: boolean

- action: bulk_write
  inputs:
    collection: string
    database: string
    operations: list[mongo_bulk_operation]
    ordered: boolean = true
  outputs:
    deleted_count: int
    inserted_count: int
    matched_count: int
    modified_count: int
    success: boolean
    upserted_count: int

- object: mongo_document
  class:
    _id: string
    collection: string
    database: string
    document: mongo_document_data

- object: mongo_document_data
  class:
    data: map[string, any]

- object: mongo_filter
  class:
    conditions: map[string, any]

- object: mongo_projection
  class:
    fields: map[string, integer]

- object: mongo_sort
  class:
    fields: map[string, integer]

- object: mongo_update
  class:
    operators: map[string, any]

- object: mongo_pipeline_stage
  class:
    stage: map[string, any]

- object: mongo_index_keys
  class:
    fields: map[string, integer]

- object: mongo_bulk_operation
  class:
    operation_type: string
    filter: mongo_filter
    document: mongo_document_data
    update: mongo_update

- object: connection
  schema:
    - connection_string: string? #max(1000)
    - created_at: date = now()
    - database: string #max(255)
    - host: string #max(255)
    - is_active: boolean = true
    - port: int = 27017 #min(1) #max(65535)
    - updated_at: date = now()
    - use_ssl: boolean = false

- object: collection
  id: [connection_id, name]
  schema:
    - connection_id: id -> mongodb_connection.id
    - created_at: date = now()
    - document_count: int = 0 #min(0)

    - name: string #max(255)
    - size: int = 0 #min(0)

- object: index
  id: [collection_id, name]
  schema:
    - collection_id: id -> mongodb_collection.id
    - created_at: date = now()
    - is_unique: boolean = false
    - keys: string # json

    - name: string #max(255)

- object: query_log
  id: [collection_id, executed_at]
  schema:
    - collection_id: id -> mongodb_collection.id
    - documents_affected: int = 0 #min(0)
    - duration_ms: int? #min(0)
    - error_message: string? #max(1000)
    - executed_at: date = now()
    - operation: insert | find | update | delete | aggregate | bulk_write = find
    - status: success | failed | timeout = success
    - user_id: id? -> user.id

- object: mongo_document
  schema:
    - _id: string
    - collection: string
    - database: string
    - document: mongo_document_data

- object: mongo_document_data
  schema:
    - data: map[string, any]

- object: mongo_filter
  schema:
    - conditions: map[string, any]

- object: mongo_projection
  schema:
    - fields: map[string, integer]

- object: mongo_sort
  schema:
    - fields: map[string, integer]

- object: mongo_update
  schema:
    - operators: map[string, any]

- object: mongo_pipeline_stage
  schema:
    - stage: map[string, any]

- object: mongo_index_keys
  schema:
    - fields: map[string, integer]

- object: mongo_bulk_operation
  schema:
    - operation_type: string
    - filter: mongo_filter
    - document: mongo_document_data
    - update: mongo_update
