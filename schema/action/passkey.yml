- name: Generate Registration Options
  action: generate_registration_options
  inputs:
    attestation: None | Indirect | Direct | Enterprise = None
    authenticator_selection: PasskeyAuthenticatorSelection
    exclude_credentials: List[PasskeyCredentialDescriptor]
    relying_party_id: String #required
    relying_party_name: String #required
    timeout: Int = 60000
    user_display_name: String #required
    user_id: String #required
    user_name: String #required
  outputs:
    challenge: String
    options: PasskeyRegistrationOptions

- name: Verify Registration Response
  action: verify_registration
  inputs:
    expected_challenge: String #required
    expected_origin: String #required
    expected_rp_id: String #required
    require_user_verification: Boolean = true
    response: PasskeyRegistrationResponse #required
  outputs:
    aaguid: String
    attestation_object: bytes
    counter: Int
    credential_backed_up: Boolean
    credential_device_type: String
    credential_id: String
    credential_public_key: bytes
    verified: Boolean

- name: Generate Authentication Options
  action: generate_authentication_options
  inputs:
    allow_credentials: List[PasskeyCredentialDescriptor]
    relying_party_id: String #required
    timeout: Int = 60000
    user_verification: Required | Preferred | Discouraged = Preferred
  outputs:
    challenge: String
    options: PasskeyAuthenticationOptions

- name: Verify Authentication Response
  action: verify_authentication
  inputs:
    credential_current_counter: Int #required
    credential_public_key: bytes #required
    expected_challenge: String #required
    expected_origin: String #required
    expected_rp_id: String #required
    require_user_verification: Boolean = true
    response: PasskeyAuthenticationResponse #required
  outputs:
    credential_backed_up: Boolean
    credential_device_type: String
    new_counter: Int
    verified: Boolean

- name: Store Passkey Credential
  action: store_credential
  inputs:
    aaguid: String
    backed_up: Boolean
    counter: Int #required
    credential_id: String #required
    credential_public_key: bytes #required
    device_type: String
    friendly_name: String
    transports: List[String]
    user_id: String #required
  outputs:
    passkey_id: String
    success: Boolean

- name: Get User Passkeys
  action: get_user_passkeys
  inputs:
    user_id: String #required
  outputs:
    count: Int
    passkeys: List[PasskeyInfo]

- name: Get Passkey By Credential ID
  action: get_passkey
  inputs:
    credential_id: String #required
  outputs:
    backed_up: Boolean
    counter: Int
    created_at: Date
    credential_id: String
    credential_public_key: bytes
    device_type: String
    friendly_name: String
    last_used_at: Date
    passkey_id: String
    transports: List[String]
    user_id: String

- name: Update Passkey Counter
  action: update_counter
  inputs:
    credential_id: String #required
    new_counter: Int #required
  outputs:
    success: Boolean

- name: Delete Passkey
  action: delete_passkey
  inputs:
    passkey_id: String #required
    user_id: String #required
  outputs:
    success: Boolean

- name: Update Passkey Name
  action: update_passkey_name
  inputs:
    friendly_name: String #required
    passkey_id: String #required
  outputs:
    success: Boolean

- name: Check Passkey Support
  action: check_support
  inputs:
    user_agent: String #required
  outputs:
    conditional_mediation: Boolean
    platform_authenticator: Boolean
    user_verifying_platform_authenticator: Boolean

- name: Passkey
  class:
    passkey_id: String
    credential_id: String
    user_id: String
    credential_public_key: bytes
    counter: Int
    device_type: String
    backed_up: Boolean
    friendly_name: String
    created_at: Date
    last_used_at: Date

- name: PasskeyAuthenticatorSelection
  class:
    authenticator_attachment: String
    resident_key: String
    require_resident_key: Boolean
    user_verification: String

- name: PasskeyCredentialDescriptor
  class:
    id: String
    type: String
    transports: List[String]

- name: PasskeyRegistrationOptions
  class:
    rp: PasskeyRelyingParty
    user: PasskeyUser
    challenge: String
    pub_key_cred_params: List[PasskeyCredParam]
    timeout: Int
    attestation: String

- name: PasskeyRelyingParty
  class:
    id: String
    name: String

- name: PasskeyUser
  class:
    id: String
    name: String
    display_name: String

- name: PasskeyCredParam
  class:
    type: String
    alg: Int

- name: PasskeyRegistrationResponse
  class:
    id: String
    raw_id: String
    response: PasskeyAuthenticatorAttestationResponse
    type: String

- name: PasskeyAuthenticatorAttestationResponse
  class:
    client_data_json: String
    attestation_object: String

- name: PasskeyAuthenticationOptions
  class:
    challenge: String
    timeout: Int
    rp_id: String
    allow_credentials: List[PasskeyCredentialDescriptor]
    user_verification: String

- name: PasskeyAuthenticationResponse
  class:
    id: String
    raw_id: String
    response: PasskeyAuthenticatorAssertionResponse
    type: String

- name: PasskeyAuthenticatorAssertionResponse
  class:
    client_data_json: String
    authenticator_data: String
    signature: String
    user_handle: String

- name: PasskeyInfo
  class:
    passkey_id: String
    credential_id: String
    friendly_name: String
    device_type: String
    created_at: Date
    last_used_at: Date
