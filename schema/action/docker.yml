- action: build
  inputs:
    build_args: map[string, string]
    context: string
    dockerfile: string = "dockerfile"
    no_cache: boolean = false
    platform: string
    pull: boolean = false
    tags: list[string]
    target: string
  outputs:
    image_id: string
    size: int
    success: boolean

- action: push
  inputs:
    all_tags: boolean = false
    image: string
    tag: string
  outputs:
    digest: string
    success: boolean

- action: pull
  inputs:
    all_tags: boolean = false
    image: string
    platform: string
    tag: string = "latest"
  outputs:
    digest: string
    image_id: string
    success: boolean

- action: list_images
  inputs:
    all: boolean = false
    filters: docker_image_filters
  outputs:
    images: list[docker_image]
    total: int

- action: remove_image
  inputs:
    force: boolean = false
    image: string
    no_prune: boolean = false
  outputs:
    success: boolean

- action: tag
  inputs:
    source: string
    target: string
  outputs:
    success: boolean

- action: run
  inputs:
    command: list[string]
    detach: boolean = false
    entrypoint: string
    env: map[string, string]
    image: string
    labels: map[string, string]
    name: string
    network: string
    ports: list[docker_port_mapping]
    remove: boolean = false
    restart: no | always | on-failure | unless-stopped = no
    volumes: list[docker_volume_mount]
    working_dir: string
  outputs:
    container_id: string
    exit_code: int
    logs: string
    success: boolean

- action: start
  inputs:
    container: string
  outputs:
    success: boolean

- action: stop
  inputs:
    container: string
    timeout: int = 10
  outputs:
    success: boolean

- action: restart
  inputs:
    container: string
    timeout: int = 10
  outputs:
    success: boolean

- action: remove_container
  inputs:
    container: string
    force: boolean = false
    volumes: boolean = false
  outputs:
    success: boolean

- action: list_containers
  inputs:
    all: boolean = false
    filters: docker_container_filters
    limit: int
  outputs:
    containers: list[docker_container]
    total: int

- action: logs
  inputs:
    container: string
    follow: boolean = false
    since: string
    tail: int
    timestamps: boolean = false
    until: string
  outputs:
    logs: string

- action: exec
  inputs:
    command: list[string]
    container: string
    detach: boolean = false
    env: map[string, string]
    privileged: boolean = false
    tty: boolean = false
    user: string
    working_dir: string
  outputs:
    exit_code: int
    output: string
    success: boolean

- action: inspect_container
  inputs:
    container: string
  outputs:
    config: docker_container_config
    created: date
    id: string
    image: string
    name: string
    network_settings: docker_network_settings
    state: docker_container_state

- action: create_network
  inputs:
    driver: bridge | host | overlay | macvlan | none = bridge
    labels: map[string, string]
    name: string
    options: map[string, string]
  outputs:
    network_id: string
    success: boolean

- action: remove_network
  inputs:
    network: string
  outputs:
    success: boolean

- action: list_networks
  inputs:
    filters: docker_network_filters
  outputs:
    networks: list[docker_network]
    total: int

- action: create_volume
  inputs:
    driver: string = "local"
    labels: map[string, string]
    name: string
    options: map[string, string]
  outputs:
    success: boolean
    volume_name: string

- action: remove_volume
  inputs:
    force: boolean = false
    volume: string
  outputs:
    success: boolean

- action: list_volumes
  inputs:
    filters: docker_volume_filters
  outputs:
    total: int
    volumes: list[docker_volume]

- action: login
  inputs:
    password: string
    registry: string
    username: string
  outputs:
    success: boolean

- action: logout
  inputs:
    registry: string
  outputs:
    success: boolean

- object: image
  class:
    id: string
    tags: list[string]
    created: date
    size: int
    labels: map[string, string]

- object: container
  class:
    id: string
    name: string
    image: string
    status: string
    state: string
    created: date
    ports: list[docker_port_mapping]

- object: container_state
  class:
    status: string
    running: boolean
    paused: boolean
    restarting: boolean
    exit_code: int
    started_at: date
    finished_at: date

- object: container_config
  class:
    hostname: string
    user: string
    env: list[string]
    cmd: list[string]
    working_dir: string
    entrypoint: list[string]
    labels: map[string, string]

- object: network_settings
  class:
    networks: map[string, docker_network_endpoint]
    ip_address: string
    gateway: string

- object: network_endpoint
  class:
    network_id: string
    ip_address: string
    gateway: string

- object: port_mapping
  class:
    container_port: int
    host_port: int
    protocol: string

- object: volume_mount
  class:
    source: string
    target: string
    read_only: boolean

- object: network
  class:
    id: string
    name: string
    driver: string
    scope: string
    created: date

- object: volume
  class:
    name: string
    driver: string
    mountpoint: string
    created: date
    labels: map[string, string]

- object: image_filters
  class:
    dangling: boolean
    label: list[string]
    reference: list[string]

- object: container_filters
  class:
    id: list[string]
    name: list[string]
    status: list[string]
    label: list[string]

- object: network_filters
  class:
    driver: list[string]
    id: list[string]
    name: list[string]

- object: volume_filters
  class:
    dangling: boolean
    driver: list[string]
    name: list[string]

- object: image
  id: [image_id]
  schema:
    - created_at: date = now()
    - digest: string? #max(200)
    - image_id: string #max(200)
    - platform: string? #max(50)
    - repository: string? #max(500)
    - size: int? #min(0)
    - tags: string? #jsonarray
    - updated_at: date = now()

- object: container
  id: [container_id]
  schema:
    - command: string? #max(2000)
    - container_id: string #max(200)
    - created_at: date = now()
    - exit_code: int?
    - image_id: string #max(200)
    - labels: string? # json map

    - name: string? #max(255)
    - network: string? #max(100)
    - ports: string? #jsonarray
    - restart_policy: no | always | on_failure | unless_stopped = no
    - started_at: date?
    - status: created | running | paused | restarting | exited | dead = created
    - stopped_at: date?
    - updated_at: date = now()

- object: network
  id: [network_id]
  schema:
    - created_at: date = now()
    - driver: bridge | host | overlay | macvlan | none = bridge
    - labels: string? # json map

    - name: string #max(255)
    - network_id: string #max(200)
    - subnet: string? #max(50)

- object: volume
  id: [name]
  schema:
    - created_at: date = now()
    - driver: string = local #max(100)
    - labels: string? # json map
    - mountpoint: string? #max(2000)

    - name: string #unique #max(255)

- object: container_state
  schema:
    - status: string
    - running: boolean
    - paused: boolean
    - restarting: boolean
    - exit_code: int
    - started_at: date
    - finished_at: date

- object: container_config
  schema:
    - hostname: string
    - user: string
    - env: list[string]
    - cmd: list[string]
    - working_dir: string
    - entrypoint: list[string]
    - labels: map[string, string]

- object: network_settings
  schema:
    - networks: map[string, docker_network_endpoint]
    - ip_address: string
    - gateway: string

- object: network_endpoint
  schema:
    - network_id: string
    - ip_address: string
    - gateway: string

- object: port_mapping
  schema:
    - container_port: int
    - host_port: int
    - protocol: string

- object: volume_mount
  schema:
    - source: string
    - target: string
    - read_only: boolean

- object: image_filters
  schema:
    - dangling: boolean
    - label: list[string]
    - reference: list[string]

- object: container_filters
  schema:
    - id: list[string]

    - name: list[string]
    - status: list[string]
    - label: list[string]

- object: network_filters
  schema:
    - driver: list[string]
    - id: list[string]

    - name: list[string]

- object: volume_filters
  schema:
    - dangling: boolean
    - driver: list[string]

    - name: list[string]
