- action: get
  inputs:
    bucket: string
    key: string
    only_if: r2_conditional
    range: r2_range
  outputs:
    body: bytes
    custom_metadata: any
    etag: string
    http_etag: string
    http_metadata: r2_http_metadata
    key: string
    size: int
    uploaded: date
    version: string

- action: head
  inputs:
    bucket: string
    key: string
  outputs:
    custom_metadata: any
    etag: string
    http_etag: string
    http_metadata: r2_http_metadata
    key: string
    size: int
    uploaded: date
    version: string

- action: put
  inputs:
    bucket: string
    custom_metadata: any
    http_metadata: r2_http_metadata
    key: string
    md5: string
    only_if: r2_conditional
    sha1: string
    sha256: string
    sha384: string
    sha512: string
    storage_class: standard | infrequent_access = standard
    value: bytes
  outputs:
    etag: string
    key: string
    size: int
    success: boolean
    uploaded: date
    version: string

- action: delete
  inputs:
    bucket: string
    key: string
  outputs:
    success: boolean

- action: delete_many
  inputs:
    bucket: string
    keys: list[string]
  outputs:
    success: boolean

- action: list
  inputs:
    bucket: string
    cursor: string
    delimiter: string
    include: list[http_metadata | custom_metadata]
    limit: int = 1000
    prefix: string
    start_after: string
  outputs:
    cursor: string
    delimited_prefixes: list[string]
    objects: list[r2_object]
    truncated: boolean

- action: create_multipart_upload
  inputs:
    bucket: string
    custom_metadata: any
    http_metadata: r2_http_metadata
    key: string
    storage_class: standard | infrequent_access = standard
  outputs:
    key: string
    upload_id: string

- action: upload_part
  inputs:
    bucket: string
    key: string
    part_number: int
    upload_id: string
    value: bytes
  outputs:
    etag: string
    part_number: int

- action: complete_multipart_upload
  inputs:
    bucket: string
    key: string
    parts: list[r2_uploaded_part]
    upload_id: string
  outputs:
    etag: string
    key: string
    size: int
    success: boolean
    uploaded: date
    version: string

- action: abort_multipart_upload
  inputs:
    bucket: string
    key: string
    upload_id: string
  outputs:
    success: boolean

- object: bucket
  id: [account_id, bucket_name]
  schema:
    - account_id: string #max(50)
    - bucket_name: string #unique #max(63)
    - created_at: date = now()
    - location: string? #max(50)
    - storage_class: standard | infrequent_access = standard
    - updated_at: date = now()

- object: object
  id: [bucket_id, key]
  schema:
    - bucket_id: id -> cf_r2_bucket.id
    - custom_metadata: string? # json
    - etag: string? #max(255)
    - http_etag: string? #max(255)
    - key: string #max(1024)
    - size: int? #min(0)
    - storage_class: standard | infrequent_access = standard
    - uploaded: date?
    - version: string? #max(255)

- object: multipart_upload
  id: [bucket_id, key, upload_id]
  schema:
    - bucket_id: id -> cf_r2_bucket.id
    - completed_at: date?
    - created_at: date = now()
    - custom_metadata: string? # json
    - key: string #max(1024)
    - status: initiated | in_progress | completed | aborted = initiated
    - storage_class: standard | infrequent_access = standard
    - upload_id: string #unique #max(255)

- object: multipart_part
  id: [upload_id, part_number]
  schema:
    - created_at: date = now()
    - etag: string? #max(255)
    - part_number: int #min(1)
    - size: int? #min(0)
    - upload_id: id -> cf_r2_multipart_upload.id
