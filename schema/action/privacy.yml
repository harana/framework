- action: record_consent
  inputs:
    consent_type: marketing | analytics | functional | necessary
    granted: boolean
    ip_address: string
    metadata: map[string, any]
    user_agent: string
    user_id: string
    version: string
  outputs:
    consent_id: string
    success: boolean
    timestamp: int
    user_id: string

- action: revoke_consent
  inputs:
    consent_type: marketing | analytics | functional | necessary
    reason: string
    user_id: string
  outputs:
    consent_id: string
    revoked_at: int
    success: boolean
    user_id: string

- action: get_consent_status
  inputs:
    consent_type: marketing | analytics | functional | necessary
    user_id: string
  outputs:
    consents: list[privacy_consent]
    user_id: string

- action: update_consent
  inputs:
    consent_id: string
    granted: boolean
    version: string
  outputs:
    consent_id: string
    success: boolean

- action: export_data
  inputs:
    exclude_sections: list[string]
    format: json | csv | xml = json
    include_sections: list[string]
    user_id: string
  outputs:
    download_url: string
    expires_at: int
    export_id: string
    status: string
    user_id: string

- action: get_export_status
  inputs:
    export_id: string
  outputs:
    completed_at: int
    created_at: int
    download_url: string
    export_id: string
    status: pending | processing | completed | failed

- action: delete_data
  inputs:
    delete_type: soft | hard = soft
    reason: string
    retain_sections: list[string]
    user_id: string
  outputs:
    deletion_id: string
    scheduled_at: int
    status: string
    success: boolean
    user_id: string

- action: get_deletion_status
  inputs:
    deletion_id: string
  outputs:
    completed_at: int
    deletion_id: string
    scheduled_at: int
    status: pending | processing | completed | failed
    user_id: string

- action: cancel_deletion
  inputs:
    deletion_id: string
  outputs:
    cancelled: boolean
    deletion_id: string
    success: boolean

- action: anonymize_data
  inputs:
    retain_sections: list[string]
    user_id: string
  outputs:
    anonymization_id: string
    success: boolean
    user_id: string

- action: list_consent_history
  inputs:
    consent_type: marketing | analytics | functional | necessary
    end_date: int
    limit: int = 100
    start_date: int
    user_id: string
  outputs:
    history: list[privacy_consent_history]
    total: int
    user_id: string

- action: record_data_access
  inputs:
    access_type: read | write | delete
    accessor_id: string
    purpose: string
    resource: string
    user_id: string
  outputs:
    access_id: string
    success: boolean
    timestamp: int

- action: get_access_log
  inputs:
    end_date: int
    limit: int = 100
    start_date: int
    user_id: string
  outputs:
    accesses: list[privacy_data_access]
    total: int
    user_id: string

- action: create_policy_version
  inputs:
    content: string
    effective_date: int
    title: string
    version: string
  outputs:
    policy_id: string
    success: boolean
    version: string

- action: get_active_policy
  inputs:
    policy_type: privacy | terms | cookie = privacy
  outputs:
    content: string
    effective_date: int
    policy_id: string
    version: string

- action: record_policy_acceptance
  inputs:
    ip_address: string
    policy_id: string
    user_agent: string
    user_id: string
  outputs:
    acceptance_id: string
    success: boolean
    timestamp: int
    user_id: string

- action: verify_rtbf_eligibility
  inputs:
    user_id: string
  outputs:
    blocking_factors: list[string]
    eligible: boolean
    reasons: list[string]
    user_id: string

- object: consent
  class:
    consent_id: string
    user_id: string
    consent_type: string
    granted: boolean
    version: string
    timestamp: date
    ip_address: string
    user_agent: string

- object: consent
  class:
    consent_id: string
    consent_type: string
    granted: boolean
    version: string
    timestamp: date

- object: consent_history
  class:
    consent_id: string
    consent_type: string
    granted: boolean
    version: string
    method: string
    timestamp: date

- object: data_access
  class:
    access_id: string
    accessor_id: string
    access_type: string
    resource: string
    purpose: string
    timestamp: date

- object: consent
  id: [user_id, consent_type]
  schema:
    - consent_type: marketing | analytics | functional | necessary = necessary
    - granted: boolean = false
    - granted_at: date?
    - ip_address: string? #max(45)
    - revoked_at: date?
    - updated_at: date = now()
    - user_agent: string? #max(500)
    - user_id: id -> user.id
    - version: string #max(50)

- object: consent_history
  id: [user_id, consent_type, created_at]
  schema:
    - action: granted | revoked | updated = granted
    - consent_type: marketing | analytics | functional | necessary = necessary
    - created_at: date = now()
    - ip_address: string? #max(45)
    - user_id: id -> user.id
    - version: string? #max(50)

- object: data_export
  id: [user_id, created_at]
  schema:
    - completed_at: date?
    - created_at: date = now()
    - download_url: string? #url
    - expires_at: date?
    - format: json | csv | xml = json
    - status: pending | processing | completed | failed = pending
    - user_id: id -> user.id

- object: data_deletion
  id: [user_id, created_at]
  schema:
    - cancelled_at: date?
    - completed_at: date?
    - created_at: date = now()
    - delete_type: soft | hard = soft
    - reason: string #max(500)
    - scheduled_at: date?
    - status: pending | processing | completed | failed | cancelled = pending
    - user_id: id -> user.id

- object: data_access_log
  id: [user_id, accessed_at]
  schema:
    - access_type: read | write | delete = read
    - accessed_at: date = now()
    - accessor_id: string #max(200)
    - purpose: string? #max(500)
    - resource: string #max(200)
    - user_id: id -> user.id

- object: policy_version
  id: [version]
  schema:
    - content: string
    - created_at: date = now()
    - effective_date: date
    - is_active: boolean = false
    - policy_type: privacy | terms | cookie = privacy
    - title: string #max(500)
    - version: string #unique #max(50)

- object: consent
  schema:
    - consent_id: string
    - user_id: string
    - consent_type: string
    - granted: boolean
    - version: string
    - timestamp: date
    - ip_address: string
    - user_agent: string

- object: data_access
  schema:
    - access_id: string
    - accessor_id: string
    - access_type: string
    - resource: string
    - purpose: string
    - timestamp: date
