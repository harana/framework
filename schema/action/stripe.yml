- action: create_payment_intent
  inputs:
    amount: int
    capture_method: automatic | manual = automatic
    confirm: boolean = false
    currency: string
    customer_id: string
    description: string
    metadata: map[string, string]
    payment_method: string
  outputs:
    amount: int
    client_secret: string
    payment_intent_id: string
    status: string

- action: confirm_payment_intent
  inputs:
    payment_intent_id: string
    payment_method: string
  outputs:
    payment_intent_id: string
    status: string
    success: boolean

- action: capture_payment_intent
  inputs:
    amount_to_capture: int
    payment_intent_id: string
  outputs:
    amount_captured: int
    payment_intent_id: string
    status: string

- action: cancel_payment_intent
  inputs:
    cancellation_reason: duplicate | fraudulent | requested_by_customer | abandoned
    payment_intent_id: string
  outputs:
    payment_intent_id: string
    status: string
    success: boolean

- action: create_customer
  inputs:
    description: string
    email: string
    metadata: map[string, string]
    name: string
    payment_method: string
    phone: string
  outputs:
    created: int
    customer_id: string
    email: string

- action: update_customer
  inputs:
    customer_id: string
    description: string
    email: string
    metadata: map[string, string]
    name: string
    phone: string
  outputs:
    customer_id: string
    success: boolean

- action: delete_customer
  inputs:
    customer_id: string
  outputs:
    customer_id: string
    deleted: boolean

- action: get_customer
  inputs:
    customer_id: string
  outputs:
    created: int
    customer_id: string
    email: string
    metadata: map[string, string]
    name: string
    phone: string

- action: create_subscription
  inputs:
    customer_id: string
    metadata: map[string, string]
    price_id: string
    quantity: int = 1
    trial_period_days: int
  outputs:
    current_period_end: int
    status: string
    subscription_id: string

- action: cancel_subscription
  inputs:
    cancel_at_period_end: boolean = false
    subscription_id: string
  outputs:
    canceled_at: int
    status: string
    subscription_id: string

- action: create_refund
  inputs:
    amount: int
    metadata: map[string, string]
    payment_intent_id: string
    reason: duplicate | fraudulent | requested_by_customer
  outputs:
    amount: int
    refund_id: string
    status: string

- action: create_price
  inputs:
    currency: string
    metadata: map[string, string]
    product_id: string
    recurring_interval: day | week | month | year
    recurring_interval_count: int = 1
    unit_amount: int
  outputs:
    currency: string
    price_id: string
    unit_amount: int

- action: create_product
  inputs:
    active: boolean = true
    description: string
    images: list[string]
    metadata: map[string, string]
    name: string
  outputs:
    created: int
    name: string
    product_id: string

- action: create_checkout_session
  inputs:
    cancel_url: string
    customer_email: string
    customer_id: string
    line_items: list[stripe_line_item]
    metadata: map[string, string]
    mode: payment | subscription | setup
    success_url: string
  outputs:
    session_id: string
    url: string

- action: retrieve_payment_intent
  inputs:
    payment_intent_id: string
  outputs:
    amount: int
    currency: string
    customer_id: string
    metadata: map[string, string]
    payment_intent_id: string
    status: string

- action: list_customers
  inputs:
    ending_before: string
    limit: int = 10
    starting_after: string
  outputs:
    customers: list[stripe_customer]
    has_more: boolean

- action: create_payment_method
  inputs:
    billing_details: stripe_billing_details
    card: stripe_card
    type: card | bank_account | us_bank_account
  outputs:
    created: int
    payment_method_id: string
    type: string

- action: attach_payment_method
  inputs:
    customer_id: string
    payment_method_id: string
  outputs:
    customer_id: string
    payment_method_id: string
    success: boolean

- object: payment_intent
  class:
    payment_intent_id: string
    amount: int
    currency: string
    status: string
    customer_id: string
    payment_method: string
    client_secret: string
    created: date

- object: line_item
  class:
    price_id: string
    quantity: int

- object: customer
  class:
    customer_id: string
    email: string
    name: string
    phone: string
    created: date
    metadata: map[string, string]

- object: billing_details
  class:
    name: string
    email: string
    phone: string
    address: stripe_address

- object: address
  class:
    line1: string
    line2: string
    city: string
    state: string
    postal_code: string
    country: string

- object: card
  class:
    number: string
    exp_month: int
    exp_year: int
    cvc: string

- object: customer
  id: [customer_id]
  schema:
    - created_at: date = now()
    - customer_id: string #unique #max(200)
    - description: string? #max(500)
    - email: string? #email #max(255)
    - metadata: string? # json

    - name: string? #max(200)
    - phone: string? #max(20)
    - updated_at: date = now()
    - user_id: id? -> user.id

- object: payment_intent
  id: [payment_intent_id]
  schema:
    - amount: int #min(0)
    - capture_method: automatic | manual = automatic
    - client_secret: string? #max(500)
    - created_at: date = now()
    - currency: string #max(3)
    - customer_id: string? #max(200)
    - description: string? #max(500)
    - metadata: string? # json
    - payment_intent_id: string #unique #max(200)
    - payment_method: string? #max(200)
    - status: requires_payment_method | requires_confirmation | requires_action | processing | succeeded | cancelled = requires_payment_method
    - updated_at: date = now()

- object: subscription
  id: [subscription_id]
  schema:
    - cancel_at_period_end: boolean = false
    - cancelled_at: date?
    - created_at: date = now()
    - current_period_end: date?
    - current_period_start: date?
    - customer_id: string #max(200)
    - metadata: string? # json
    - price_id: string #max(200)
    - quantity: int = 1 #min(1)
    - status: active | past_due | cancelled | incomplete | trialing | unpaid = active
    - subscription_id: string #unique #max(200)
    - trial_end: date?
    - updated_at: date = now()

- object: product
  id: [product_id]
  schema:
    - created_at: date = now()
    - description: string? #max(500)
    - is_active: boolean = true
    - metadata: string? # json

    - name: string #max(200)
    - product_id: string #unique #max(200)
    - updated_at: date = now()

- object: price
  id: [price_id]
  schema:
    - created_at: date = now()
    - currency: string #max(3)
    - is_active: boolean = true
    - price_id: string #unique #max(200)
    - product_id: string #max(200)
    - recurring_interval: day | week | month | year?
    - recurring_interval_count: int = 1 #min(1)
    - unit_amount: int #min(0)

- object: refund
  id: [refund_id]
  schema:
    - amount: int #min(0)
    - created_at: date = now()
    - metadata: string? # json
    - payment_intent_id: string #max(200)
    - reason: duplicate | fraudulent | requested_by_customer?
    - refund_id: string #unique #max(200)
    - status: pending | succeeded | failed | cancelled = pending

- object: webhook_event
  id: [event_id]
  schema:
    - created_at: date = now()
    - event_id: string #unique #max(200)
    - event_type: string #max(200)
    - payload: string
    - processed_at: date?
    - status: pending | processed | failed = pending

- object: line_item
  schema:
    - price_id: string
    - quantity: int

- object: billing_details
  schema:
    - name: string
    - email: string
    - phone: string
    - address: stripe_address

- object: address
  schema:
    - line1: string
    - line2: string
    - city: string
    - state: string
    - postal_code: string
    - country: string

- object: card
  schema:
    - number: string
    - exp_month: int
    - exp_year: int
    - cvc: string
