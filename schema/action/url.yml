- action: parse
  inputs:
    url: string
  outputs:
    fragment: string
    host: string
    path: string
    port: int
    protocol: string
    query: map[string, string]

- action: build
  inputs:
    fragment: string
    host: string
    path: string
    port: int
    protocol: string = "https"
    query: map[string, string]
  outputs:
    url: string

- action: encode
  inputs:
    component: boolean = true
    data: string
  outputs:
    encoded: string

- action: decode
  inputs:
    component: boolean = true
    data: string
  outputs:
    decoded: string

- action: shorten
  inputs:
    custom_alias: string
    expiration: string
    url: string
  outputs:
    short_url: string

- action: expand
  inputs:
    url: string
  outputs:
    original_url: string

- action: validate
  inputs:
    allowed_protocols: list[string]
    require_tld: boolean = true
    url: string
  outputs:
    errors: list[string]
    valid: boolean

- object: url
  class:
    url: string
    protocol: string
    host: string
    port: int
    path: string
    query: map[string, string]
    fragment: string

- object: short_url
  id: [alias]
  schema:
    - alias: string #unique #max(100)
    - click_count: int = 0 #min(0)
    - created_at: date = now()
    - created_by: id? -> user.id
    - expires_at: date?
    - is_active: boolean = true
    - original_url: string #url #max(2000)
    - short_url: string #url #max(500)

- object: short_url_click
  id: [short_url_id, clicked_at]
  schema:
    - clicked_at: date = now()
    - ip_address: string? #max(45)
    - referrer: string? #max(2000)
    - short_url_id: id -> short_url.id
    - user_agent: string? #max(500)

- object: url
  schema:
    - url: string
    - protocol: string
    - host: string
    - port: int
    - path: string
    - query: map[string, string]
    - fragment: string
