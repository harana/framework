- action: send_message
  inputs:
    attachments: list[teams_attachment]
    channel_id: string
    content: string
    content_type: text | html = text
    importance: normal | high | urgent = normal
    mentions: list[teams_mention]
    team_id: string
  outputs:
    created_at: date
    message_id: string
    success: boolean

- action: reply_to_message
  inputs:
    attachments: list[teams_attachment]
    channel_id: string
    content: string
    content_type: text | html = text
    message_id: string
    team_id: string
  outputs:
    reply_id: string
    success: boolean

- action: update_message
  inputs:
    channel_id: string
    content: string
    content_type: text | html = text
    message_id: string
    team_id: string
  outputs:
    success: boolean

- action: delete_message
  inputs:
    channel_id: string
    message_id: string
    team_id: string
  outputs:
    success: boolean

- action: send_chat_message
  inputs:
    attachments: list[teams_attachment]
    chat_id: string
    content: string
    content_type: text | html = text
  outputs:
    message_id: string
    success: boolean

- action: create_channel
  inputs:
    description: string
    display_name: string
    membership_type: standard | private | shared = standard
    team_id: string
  outputs:
    channel_id: string
    success: boolean
    web_url: string

- action: delete_channel
  inputs:
    channel_id: string
    team_id: string
  outputs:
    success: boolean

- action: list_channels
  inputs:
    filter: string
    team_id: string
  outputs:
    channels: list[teams_channel]
    count: int

- action: get_channel_messages
  inputs:
    channel_id: string
    order_by: string
    team_id: string
    top: int = 50
  outputs:
    messages: list[teams_message]
    next_link: string

- action: create_meeting
  inputs:
    allow_new_time_proposals: boolean = true
    attendees: list[string]
    body: string
    end_time: date
    is_online_meeting: boolean = true
    location: string
    start_time: date
    subject: string
  outputs:
    join_url: string
    meeting_id: string
    success: boolean

- action: get_meeting
  inputs:
    meeting_id: string
  outputs:
    attendees: list[teams_attendee]
    end_time: date
    join_url: string
    meeting_id: string
    start_time: date
    subject: string

- action: cancel_meeting
  inputs:
    comment: string
    meeting_id: string
  outputs:
    success: boolean

- action: list_teams
  inputs:
    filter: string
    top: int = 100
  outputs:
    count: int
    teams: list[teams_team]

- action: get_team
  inputs:
    team_id: string
  outputs:
    description: string
    display_name: string
    team_id: string
    visibility: string
    web_url: string

- action: list_team_members
  inputs:
    role: owner | member
    team_id: string
  outputs:
    count: int
    members: list[teams_member]

- action: add_team_member
  inputs:
    roles: list[string]
    team_id: string
    user_id: string
  outputs:
    membership_id: string
    success: boolean

- action: remove_team_member
  inputs:
    membership_id: string
    team_id: string
  outputs:
    success: boolean

- action: send_adaptive_card
  inputs:
    card: teams_adaptive_card
    channel_id: string
    team_id: string
  outputs:
    message_id: string
    success: boolean

- action: upload_file
  inputs:
    channel_id: string
    content: bytes
    file_name: string
    folder_path: string
    team_id: string
  outputs:
    file_id: string
    success: boolean
    web_url: string

- object: teams_message
  class:
    message_id: string
    channel_id: string
    team_id: string
    content: string
    content_type: string
    created_at: date
    from_user: teams_user
    importance: string

- object: teams_user
  class:
    user_id: string
    display_name: string
    email: string

- object: teams_attachment
  class:
    id: string
    content_type: string
    content_url: string
    name: string

- object: teams_mention
  class:
    id: string
    mentioned_id: string
    mentioned_text: string

- object: teams_channel
  class:
    channel_id: string
    display_name: string
    description: string
    membership_type: string
    web_url: string

- object: teams_attendee
  class:
    email: string
    display_name: string
    response_status: string

- object: teams_team
  class:
    team_id: string
    display_name: string
    description: string
    visibility: string
    web_url: string

- object: teams_member
  class:
    membership_id: string
    user_id: string
    display_name: string
    email: string
    roles: list[string]

- object: teams_adaptive_card
  class:
    type: string
    version: string
    body: list[any]
    actions: list[any]

- object: teams_team
  id: [team_id]
  schema:
    - created_at: date = now()
    - description: string? #max(500)
    - display_name: string #max(200)
    - is_archived: boolean = false
    - team_id: string #unique #max(200)
    - visibility: public | private = private
    - web_url: string? #url

- object: teams_channel
  id: [team_id, channel_id]
  schema:
    - channel_id: string #max(200)
    - created_at: date = now()
    - description: string? #max(500)
    - display_name: string #max(200)
    - membership_type: standard | private | shared = standard
    - team_id: id -> teams_team.id
    - web_url: string? #url

- object: teams_member
  id: [team_id, user_id]
  schema:
    - display_name: string? #max(200)
    - email: string? #email #max(255)
    - joined_at: date = now()
    - membership_id: string? #max(200)
    - roles: string? # json array
    - team_id: id -> teams_team.id
    - user_id: string #max(200)

- object: teams_message
  id: [channel_id, message_id]
  schema:
    - channel_id: string #max(200)
    - content: string? #max(10000)
    - content_type: text | html = text
    - created_at: date = now()
    - importance: normal | high | urgent = normal
    - message_id: string #max(200)
    - sender_id: string? #max(200)
    - thread_id: string? #max(200)
    - updated_at: date = now()

- object: teams_meeting
  id: [meeting_id]
  schema:
    - body: string? #max(2000)
    - created_at: date = now()
    - end_time: date?
    - is_online: boolean = true
    - join_url: string? #url
    - location: string? #max(200)
    - meeting_id: string #unique #max(200)
    - organizer_id: string? #max(200)
    - start_time: date?
    - subject: string #max(500)
    - updated_at: date = now()

- object: teams_adaptive_card
  schema:
    - body: string # json card body
    - created_at: date = now()
    - description: string? #max(500)
    - is_active: boolean = true
    - schema_version: string = 1.4 #max(10)
    - updated_at: date = now()

- object: teams_user
  schema:
    - user_id: string
    - display_name: string
    - email: string

- object: teams_attachment
  schema:
    - id: string
    - content_type: string
    - content_url: string

    - name: string

- object: teams_mention
  schema:
    - id: string
    - mentioned_id: string
    - mentioned_text: string

- object: teams_attendee
  schema:
    - email: string
    - display_name: string
    - response_status: string
