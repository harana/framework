- name: docker_image
  id: [image_id]
  schema:
    - created_at: date = now()
    - digest: string? #max(200)
    - image_id: string #required #max(200)
    - platform: string? #max(50)
    - repository: string? #max(500)
    - size: int? #min(0)
    - tags: string? # j_s_o_n array
    - updated_at: date = now()

- name: docker_container
  id: [container_id]
  schema:
    - command: string? #max(2000)
    - container_id: string #required #max(200)
    - created_at: date = now()
    - exit_code: int?
    - image_id: string #required #max(200)
    - labels: string? # j_s_o_n map
    - name: string? #max(255)
    - network: string? #max(100)
    - ports: string? # j_s_o_n array
    - restart_policy: no | always | on_failure | unless_stopped = no
    - started_at: date?
    - status: created | running | paused | restarting | exited | dead = created
    - stopped_at: date?
    - updated_at: date = now()

- name: docker_network
  id: [network_id]
  schema:
    - created_at: date = now()
    - driver: bridge | host | overlay | macvlan | none = bridge
    - labels: string? # j_s_o_n map
    - name: string #required #max(255)
    - network_id: string #required #max(200)
    - subnet: string? #max(50)

- name: docker_volume
  id: [name]
  schema:
    - created_at: date = now()
    - driver: string = local #max(100)
    - labels: string? # j_s_o_n map
    - mountpoint: string? #max(2000)
    - name: string #required #unique #max(255)

- name: docker_container_state
  schema:
    - status: string
    - running: boolean
    - paused: boolean
    - restarting: boolean
    - exit_code: int
    - started_at: date
    - finished_at: date

- name: docker_container_config
  schema:
    - hostname: string
    - user: string
    - env: list[string]
    - cmd: list[string]
    - working_dir: string
    - entrypoint: list[string]
    - labels: map[string, string]

- name: docker_network_settings
  schema:
    - networks: map[string, docker_network_endpoint]
    - ip_address: string
    - gateway: string

- name: docker_network_endpoint
  schema:
    - network_id: string
    - ip_address: string
    - gateway: string

- name: docker_port_mapping
  schema:
    - container_port: int
    - host_port: int
    - protocol: string

- name: docker_volume_mount
  schema:
    - source: string
    - target: string
    - read_only: boolean

- name: docker_image_filters
  schema:
    - dangling: boolean
    - label: list[string]
    - reference: list[string]

- name: docker_container_filters
  schema:
    - id: list[string]
    - name: list[string]
    - status: list[string]
    - label: list[string]

- name: docker_network_filters
  schema:
    - driver: list[string]
    - id: list[string]
    - name: list[string]

- name: docker_volume_filters
  schema:
    - dangling: boolean
    - driver: list[string]
    - name: list[string]
