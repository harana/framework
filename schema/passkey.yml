- object: passkey_credential
  id: [credential_id]
  schema:
    - aaguid: string? #max(100)
    - backed_up: boolean = false
    - counter: int = 0 #min(0)
    - created_at: date = now()
    - credential_id: string #unique #max(500)
    - device_type: string? #max(50)
    - friendly_name: string? #max(200)
    - is_active: boolean = true
    - last_used_at: date?
    - public_key_fingerprint: string? #max(128)
    - transports: string? # j_s_o_n array
    - updated_at: date = now()
    - user_id: id -> user.id
- object: passkey_challenge
  id: [challenge]
  schema:
    - challenge: string #unique #max(500)
    - created_at: date = now()
    - expires_at: date #required
    - rp_id: string #max(255)
    - type: registration | authentication = registration
    - used: boolean = false
    - user_id: string? #max(200)

- object: passkey_auth_log
  id: [credential_id, authenticated_at]
  schema:
    - authenticated_at: date = now()
    - credential_id: string #max(500)
    - ip_address: string? #max(45)
    - success: boolean = true
    - user_agent: string? #max(500)
    - user_id: id -> user.id
- object: passkey
  schema:
    - passkey_id: string
    - credential_id: string
    - user_id: string
    - credential_public_key: bytes
    - counter: int
    - device_type: string
    - backed_up: boolean
    - friendly_name: string
    - created_at: date
    - last_used_at: date

- object: passkey_authenticator_selection
  schema:
    - authenticator_attachment: string
    - resident_key: string
    - require_resident_key: boolean
    - user_verification: string

- object: passkey_credential_descriptor
  schema:
    - id: string
    - type: string
    - transports: list[string]

- object: passkey_registration_options
  schema:
    - rp: passkey_relying_party
    - user: passkey_user
    - challenge: string
    - pub_key_cred_params: list[passkey_cred_param]
    - timeout: int
    - attestation: string

- object: passkey_relying_party
  schema:
    - id: string
    - name: string

- object: passkey_user
  schema:
    - id: string
    - name: string
    - display_name: string

- object: passkey_cred_param
  schema:
    - type: string
    - alg: int

- object: passkey_registration_response
  schema:
    - id: string
    - raw_id: string
    - response: passkey_authenticator_attestation_response
    - type: string

- object: passkey_authenticator_attestation_response
  schema:
    - client_data_json: string
    - attestation_object: string

- object: passkey_authentication_options
  schema:
    - challenge: string
    - timeout: int
    - rp_id: string
    - allow_credentials: list[passkey_credential_descriptor]
    - user_verification: string

- object: passkey_authentication_response
  schema:
    - id: string
    - raw_id: string
    - response: passkey_authenticator_assertion_response
    - type: string

- object: passkey_authenticator_assertion_response
  schema:
    - client_data_json: string
    - authenticator_data: string
    - signature: string
    - user_handle: string

- object: passkey_info
  schema:
    - passkey_id: string
    - credential_id: string
    - friendly_name: string
    - device_type: string
    - created_at: date
    - last_used_at: date
