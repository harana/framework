- name: aws_ecr_repository
  id: [account_id, repository_name]
  schema:
    - account_id: string #required #max(20)
    - created_at: date = now()
    - encryption_type: aes256 | kms = aes256
    - image_tag_mutability: mutable | immutable = mutable
    - kms_key: string? #max(255)
    - region: string? #max(50)
    - registry_id: string? #max(20)
    - repository_arn: string? #max(255)
    - repository_name: string #required #unique #max(255)
    - repository_uri: string? #max(500)
    - scan_on_push: boolean = false
    - tags: string? # json
    - updated_at: date = now()

- name: aws_ecr_image
  id: [repository_id, image_digest]
  schema:
    - created_at: date = now()
    - image_digest: string #required #max(255)
    - image_manifest_media_type: string? #max(100)
    - image_pushed_at: date?
    - image_size_bytes: int? #min(0)
    - image_tags: string? # json list
    - last_scan_at: date?
    - repository_id: id #required -> aws_ecr_repository.id
    - scan_status: in_progress | complete | failed | unsupported = in_progress
    - vulnerability_count: int = 0 #min(0)

- name: aws_ecr_repository_policy
  id: [repository_id]
  schema:
    - created_at: date = now()
    - policy_text: string #required
    - repository_id: id #required -> aws_ecr_repository.id
    - updated_at: date = now()

- name: aws_ecr_lifecycle_policy
  id: [repository_id]
  schema:
    - created_at: date = now()
    - last_evaluated_at: date?
    - lifecycle_policy_text: string #required
    - repository_id: id #required -> aws_ecr_repository.id
    - updated_at: date = now()

- name: aws_ecr_image_scan_finding
  id: [image_id, name, uri]
  schema:
    - description: string? #max(1000)
    - image_id: id #required -> aws_ecr_image.id
    - name: string #required #max(255)
    - severity: informational | low | medium | high | critical | undefined = undefined
    - uri: string? #url