- object: encryption_key
  id: [key_id]
  schema:
    - algorithm: aes_256_gcm | aes_256_cbc | rsa | ed25519 | ecdsa = aes_256_gcm
    - created_at: date = now()
    - created_by: id? -> user.id
    - expires_at: date?
    - is_active: boolean = true
    - key_id: string #unique #max(200)
    - key_size: int #min(128)
    - key_type: symmetric | asymmetric = symmetric
    - last_rotated_at: date?
    - updated_at: date = now()
    - usage: encrypt | sign | both = encrypt

- object: key_pair
  id: [key_id]
  schema:
    - algorithm: rsa | ed25519 | ecdsa = rsa
    - created_at: date = now()
    - created_by: id? -> user.id
    - expires_at: date?
    - is_active: boolean = true
    - key_id: string #unique #max(200)
    - key_size: int #min(256)
    - public_key_fingerprint: string? #max(128)
    - updated_at: date = now()

- object: crypto_operation_log
  id: [key_id, created_at]
  schema:
    - algorithm: string #max(50)
    - created_at: date = now()
    - key_id: string #max(200)
    - operation: hash | hmac | encrypt | decrypt | sign | verify | generate_key = encrypt
    - status: success | failed = success
    - user_id: id? -> user.id
