
- name: HTTP Response Sent
  class: Event_route_response_sent
  extends: Event
  schema:
    event_route: Boolean
    http_method: String #required
  set:
    attributes: $all_values
    type: route.response.sent

- name: Route Matched
  class: Event_route_matched
  extends: Event
  schema:
    handler: String #required
    matched_at: Date = now()
    path_params: String?
    request_id: Id #required
    route_name: String?
    route_pattern: String #required
  set:
    attributes: $all_values
    type: route.matched

- name: Route Not Found
  class: Event_route_not_found
  extends: Event
  schema:
    method: GET | POST | PUT | PATCH | DELETE | HEAD | OPTIONS
    occurred_at: Date = now()
    path: String #required
    request_id: Id #required
  set:
    attributes: $all_values
    type: route.not_found

- name: Request Authenticated
  class: Event_route_request_authenticated
  extends: Event
  schema:
    auth_method: Bearer | Basic | ApiKey | Session | None = None
    authenticated_at: Date = now()
    is_authenticated: Boolean = false
    request_id: Id #required
    user_id: Id?
  set:
    attributes: $all_values
    type: route.request.authenticated

- name: Request Rate Limited
  class: Event_route_request_rate_limited
  extends: Event
  schema:
    current_count: int #required #min(0)
    ip_address: String? #ip
    limit: int #required #min(1)
    limited_at: Date = now()
    request_id: Id #required
    user_id: Id?
    window_seconds: int #required #min(1)
  set:
    attributes: $all_values
    type: route.request.rate_limited
