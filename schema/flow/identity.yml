- name: authenticate
  inputs:
    mfa_code: string
    password: string #required
    username: string #required
  outputs:
    access_token: string
    expires_at: date
    refresh_token: string
    success: boolean
    user_id: string

- name: verify_token
  inputs:
    token: string #required
  outputs:
    claims: token_claims
    expires_at: date
    user_id: string
    valid: boolean

- name: refresh_token
  inputs:
    refresh_token: string #required
  outputs:
    access_token: string
    expires_at: date
    refresh_token: string

- name: revoke_token
  inputs:
    token: string #required
  outputs:
    success: boolean

- name: get_user
  inputs:
    user_id: string #required
  outputs:
    created_at: date
    email: string
    metadata: user_metadata
    roles: list[string]
    user_id: string
    username: string

- name: create_user
  inputs:
    email: string #required
    metadata: user_metadata
    password: string #required
    roles: list[string]
    username: string #required
  outputs:
    success: boolean
    user_id: string

- name: update_user
  inputs:
    email: string
    metadata: user_metadata
    roles: list[string]
    user_id: string #required
  outputs:
    success: boolean

- name: delete_user
  inputs:
    hard_delete: boolean = false
    user_id: string #required
  outputs:
    success: boolean

- name: change_password
  inputs:
    current_password: string #required
    new_password: string #required
    user_id: string #required
  outputs:
    success: boolean

- name: request_password_reset
  inputs:
    email: string #required
  outputs:
    reset_token: string
    success: boolean

- name: reset_password
  inputs:
    new_password: string #required
    reset_token: string #required
  outputs:
    success: boolean

- name: list_users
  inputs:
    limit: int = 100
    offset: int = 0
    roles: list[string]
    search: string
  outputs:
    total: int
    users: list[user_info]

- name: user
  class:
    user_id: string
    username: string
    email: string
    roles: list[string]
    metadata: user_metadata
    created_at: date
    last_login: date

- name: token_claims
  class:
    claims: map[string, any]

- name: user_metadata
  class:
    values: map[string, any]

- name: user_info
  class:
    user_id: string
    username: string
    email: string
    roles: list[string]
    created_at: date
