- action: create
  inputs:
    description: string
    kms_key_id: string
    name: string
    secret_value: string
    tags: secrets_tags
  outputs:
    arn: string
    name: string
    version_id: string

- action: get_value
  inputs:
    secret_id: string
    version_id: string
    version_stage: string
  outputs:
    arn: string
    created_date: int
    name: string
    secret_value: string
    version_id: string

- action: update
  inputs:
    description: string
    kms_key_id: string
    secret_id: string
    secret_value: string
  outputs:
    arn: string
    name: string
    version_id: string

- action: delete
  inputs:
    force_delete: boolean = false
    recovery_window_days: int = 30
    secret_id: string
  outputs:
    arn: string
    deletion_date: int
    name: string

- action: restore
  inputs:
    secret_id: string
  outputs:
    arn: string
    name: string

- action: lists
  inputs:
    filters: list[secret_filter]
    max_results: int = 100
    sort_order: asc | desc = asc
  outputs:
    next_token: string
    secrets: list[secret_list_entry]

- action: describe
  inputs:
    secret_id: string
  outputs:
    arn: string
    description: string
    kms_key_id: string
    last_changed_date: int
    last_rotated_date: int
    name: string
    rotation_enabled: boolean
    tags: secrets_tags

- action: put_value
  inputs:
    secret_id: string
    secret_value: string
    version_stages: list[string]
  outputs:
    arn: string
    name: string
    version_id: string
    version_stages: list[string]

- action: rotate
  inputs:
    rotation_lambda_arn: string
    rotation_rules: rotation_rules
    secret_id: string
  outputs:
    arn: string
    name: string
    version_id: string

- action: cancel_rotate
  inputs:
    secret_id: string
    version_id: string
  outputs:
    arn: string
    name: string
    version_id: string

- action: tag
  inputs:
    secret_id: string
    tags: secrets_tags

- action: untag
  inputs:
    secret_id: string
    tag_keys: list[string]

- action: replicate
  inputs:
    kms_key_ids: kms_key_ids
    regions: list[string]
    secret_id: string
  outputs:
    arn: string
    replication_status: list[replication_status]

- action: remove_regions_from_replication
  inputs:
    regions: list[string]
    secret_id: string
  outputs:
    arn: string
    replication_status: list[replication_status]

- action: validate
  inputs:
    secret_id: string
  outputs:
    exists: boolean
    scheduled_for_deletion: boolean
    valid: boolean

- object: aws_secrets_manager_secret
  schema:
    account_id: string
    arn: string
    created_at: date = now()
    deleted_at: date
    description: string
    kms_key_id: string
    last_changed_at: date
    last_rotated_at: date
    name: string
    region: string
    rotation_enabled: boolean = false
    rotation_lambda_arn: string
    rotation_rules: string #json
    tags: string #json
    updated_at: date = now()

- object: aws_secrets_manager_secret_version
  schema:
    created_at: date = now()
    secret_id: string
    version_id: string
    version_stages: string #json

- object: aws_secrets_manager_secret_replication
  schema:
    created_at: date = now()
    kms_key_id: string
    last_accessed_at: date
    region: string
    secret_id: string
    status: in_sync | failed | in_progress = in_progress
    status_message: string
    updated_at: date = now()

- object: aws_secrets_manager_access_log
  schema:
    accessed_at: date = now()
    action: get_value | put_value | create | update | delete | rotate | tag | untag = get_value
    ip_address: string
    secret_id: string
    success: boolean = true
    user_arn: string
