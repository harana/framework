- action: create_repository
  inputs:
    encryption_type: aes256 | kms
    image_tag_mutability: mutable | immutable = mutable
    kms_key: string
    region: string
    repository_name: string
    scan_on_push: boolean = false
    tags: ecr_tags
  outputs:
    registry_id: string
    repository_arn: string
    repository_uri: string

- action: delete_repository
  inputs:
    force: boolean = false
    region: string
    repository_name: string

- action: describe_repositories
  inputs:
    region: string
    repository_names: list[string]
  outputs:
    repositories: list[ecr_repository]

- action: list_images
  inputs:
    filter: image_filter
    max_results: int = 100
    region: string
    repository_name: string
  outputs:
    image_ids: list[image_id]
    next_token: string

- action: describe_images
  inputs:
    image_ids: list[image_id]
    region: string
    repository_name: string
  outputs:
    image_details: list[ecr_image_detail]

- action: put_image
  inputs:
    image_manifest: string
    image_tag: string
    region: string
    repository_name: string
  outputs:
    image: ecr_image

- action: batch_delete_image
  inputs:
    image_ids: list[image_id]
    region: string
    repository_name: string
  outputs:
    failures: list[image_failure]
    image_ids: list[image_id]

- action: get_auth_token
  inputs:
    region: string
    registry_ids: list[string]
  outputs:
    authorization_token: string
    expires_at: date
    proxy_endpoint: string

- action: get_download_url
  inputs:
    image_digest: string
    region: string
    repository_name: string
  outputs:
    download_url: string

- action: tag_image
  inputs:
    image_digest: string
    image_tag: string
    region: string
    repository_name: string

- action: set_repository_policy
  inputs:
    force: boolean = false
    policy_text: string
    region: string
    repository_name: string
  outputs:
    policy_text: string
    registry_id: string
    repository_name: string

- action: get_repository_policy
  inputs:
    region: string
    repository_name: string
  outputs:
    policy_text: string
    registry_id: string
    repository_name: string

- action: delete_repository_policy
  inputs:
    region: string
    repository_name: string

- action: start_image_scan
  inputs:
    image_id: image_id
    region: string
    repository_name: string
  outputs:
    image_id: image_id
    scan_status: string

- action: describe_scan_findings
  inputs:
    image_id: image_id
    max_results: int = 100
    region: string
    repository_name: string
  outputs:
    findings: list[image_scan_finding]
    image_scan_status: image_scan_status
    next_token: string

- action: put_lifecycle_policy
  inputs:
    lifecycle_policy_text: string
    region: string
    repository_name: string
  outputs:
    lifecycle_policy_text: string
    registry_id: string
    repository_name: string

- action: get_lifecycle_policy
  inputs:
    region: string
    repository_name: string
  outputs:
    last_evaluated_at: date
    lifecycle_policy_text: string
    registry_id: string
    repository_name: string

- object: aws_ecs_cluster
  schema:
    account_id: string
    active_services_count: int = 0
    capacity_providers: string #json
    cluster_arn: string
    cluster_name: string
    created_at: date = now()
    pending_tasks_count: int = 0
    region: string
    registered_container_instances_count: int = 0
    running_tasks_count: int = 0
    settings: string #json
    status: active | provisioning | deprovisioning | failed | inactive = active
    tags: string #json
    updated_at: date = now()

- object: aws_ecs_service
  schema:
    cluster_id: string
    created_at: date = now()
    desired_count: int = 1
    launch_type: ec2 | fargate | external = fargate
    load_balancers: string #json
    network_configuration: string #json
    pending_count: int = 0
    platform_version: string
    running_count: int = 0
    scheduling_strategy: replica | daemon = replica
    service_arn: string
    service_name: string
    status: active | draining | inactive = active
    tags: string #json
    task_definition: string
    updated_at: date = now()

- object: aws_ecs_task_definition
  schema:
    account_id: string
    container_definitions: string #json
    cpu: string
    created_at: date = now()
    execution_role_arn: string
    family: string
    memory: string
    network_mode: none | bridge | awsvpc | host = awsvpc
    region: string
    requires_compatibilities: string #json
    revision: int
    status: active | inactive = active
    tags: string #json
    task_definition_arn: string
    task_role_arn: string

- object: aws_ecs_task
  schema:
    cluster_id: string
    connectivity: connected | disconnected = connected
    container_instance_arn: string
    cpu: string
    created_at: date = now()
    desired_status: running | stopped = running
    group: string
    last_status: provisioning | pending | activating | running | deactivating | stopping | deprovisioning | stopped = provisioning
    launch_type: ec2 | fargate | external = fargate
    memory: string
    platform_version: string
    started_at: date
    stopped_at: date
    stopped_reason: string
    tags: string #json
    task_arn: string
    task_definition_arn: string
    updated_at: date = now()
