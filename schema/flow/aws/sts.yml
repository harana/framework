- action: assume_role
  inputs:
    duration_seconds: int = 3600
    external_id: string
    policy: string
    policy_arns: list[sts_policy_arn]
    region: string
    role_arn: string
    role_session_name: string
    serial_number: string
    source_identity: string
    tags: tags
    token_code: string
    transitive_tag_keys: list[string]
  outputs:
    access_key_id: string
    assumed_role_user: assumed_role_user
    credentials: sts_credentials
    expiration: date
    packed_policy_size: int
    secret_access_key: string
    session_token: string
    source_identity: string

- action: assume_role_with_saml
  inputs:
    duration_seconds: int = 3600
    policy: string
    policy_arns: list[sts_policy_arn]
    principal_arn: string
    region: string
    role_arn: string
    saml_assertion: string
  outputs:
    access_key_id: string
    assumed_role_user: assumed_role_user
    audience: string
    credentials: sts_credentials
    expiration: date
    issuer: string
    name_qualifier: string
    packed_policy_size: int
    secret_access_key: string
    session_token: string
    subject: string
    subject_type: string

- action: assume_role_with_web_identity
  inputs:
    duration_seconds: int = 3600
    policy: string
    policy_arns: list[sts_policy_arn]
    provider_id: string
    region: string
    role_arn: string
    role_session_name: string
    web_identity_token: string
  outputs:
    access_key_id: string
    assumed_role_user: assumed_role_user
    audience: string
    credentials: sts_credentials
    expiration: date
    packed_policy_size: int
    provider: string
    secret_access_key: string
    session_token: string
    source_identity: string
    subject_from_web_identity_token: string

- action: decode_authorization_message
  inputs:
    encoded_message: string
    region: string
  outputs:
    decoded_message: string

- action: get_caller_identity
  inputs:
    region: string
  outputs:
    account: string
    arn: string
    user_id: string

- action: get_session_token
  inputs:
    duration_seconds: int = 3600
    region: string
    serial_number: string
    token_code: string
  outputs:
    access_key_id: string
    credentials: sts_credentials
    expiration: date
    secret_access_key: string
    session_token: string

- action: get_federation_token
  inputs:
    duration_seconds: int = 3600
    name: string
    policy: string
    policy_arns: list[sts_policy_arn]
    region: string
    tags: tags
  outputs:
    access_key_id: string
    credentials: sts_credentials
    expiration: date
    federated_user: federated_user
    packed_policy_size: int
    secret_access_key: string
    session_token: string

- action: get_access_key_info
  inputs:
    access_key_id: string
    region: string
  outputs:
    account: string

- object: aws_sts_assumed_role_session
  schema:
    access_key_id: string
    account_id: string
    assumed_role_arn: string
    assumed_role_id: string
    created_at: date = now()
    expiration: date
    method: assume_role | assume_role_with_saml | assume_role_with_web_identity = assume_role
    packed_policy_size: int
    region: string
    role_arn: string
    role_session_name: string
    source_identity: string

- object: aws_sts_federation_token
  schema:
    access_key_id: string
    account_id: string
    created_at: date = now()
    expiration: date
    federated_user_arn: string
    federated_user_id: string
    name: string
    packed_policy_size: int
    region: string
