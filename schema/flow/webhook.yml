- name: Register Webhook Endpoint
  method: register
  inputs:
    active: Boolean = true
    description: String
    events: List[String] #required
    secret: String
    url: String #required
  outputs:
    secret: String
    success: Boolean
    webhook_id: String

- name: Update Webhook Configuration
  method: update
  inputs:
    active: Boolean
    description: String
    events: List[String]
    secret: String
    url: String
    webhook_id: String #required
  outputs:
    success: Boolean

- name: Unregister Webhook Endpoint
  method: unregister
  inputs:
    webhook_id: String #required
  outputs:
    success: Boolean

- name: Trigger Webhook Event
  method: trigger
  inputs:
    event: String #required
    payload: Any #required
    webhook_ids: List[String]
  outputs:
    success: Boolean
    triggered_count: Int

- name: Get Webhook Details
  method: get
  inputs:
    webhook_id: String #required
  outputs:
    active: Boolean
    created_at: Date
    description: String
    events: List[String]
    url: String

- name: List Registered Webhooks
  method: lists
  inputs:
    active_only: Boolean = false
    event: String
    limit: Int = 100
    offset: Int = 0
  outputs:
    total: Int
    webhooks: List[Webhook]

- name: Test Webhook Endpoint
  method: test
  inputs:
    payload: Any
    webhook_id: String #required
  outputs:
    error: String
    response_time_ms: Int
    status_code: Int
    success: Boolean

- name: Get Webhook Delivery Log
  method: get_deliveries
  inputs:
    limit: Int = 50
    offset: Int = 0
    status: Success | Failed | Pending
    webhook_id: String #required
  outputs:
    deliveries: List[WebhookDelivery]
    total: Int

- name: Retry Failed Delivery
  method: retry_delivery
  inputs:
    delivery_id: String #required
  outputs:
    status_code: Int
    success: Boolean

- name: Verify Webhook Signature
  method: verify_signature
  inputs:
    algorithm: Sha256 | Sha512 = Sha256
    payload: String #required
    secret: String #required
    signature: String #required
  outputs:
    valid: Boolean

- name: Rotate Webhook Secret
  method: rotate_secret
  inputs:
    webhook_id: String #required
  outputs:
    new_secret: String
    success: Boolean

- name: Webhook
  class:
    webhook_id: String
    url: String
    events: List[String]
    secret: String
    active: Boolean
    description: String
    created_at: Date

- name: WebhookDelivery
  class:
    delivery_id: String
    webhook_id: String
    event: String
    status: String
    status_code: Int
    response_time_ms: Int
    error: String
    created_at: Date
