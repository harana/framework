- name: register
  inputs:
    active: boolean = true
    description: string
    events: list[string] #required
    secret: string
    url: string #required
  outputs:
    secret: string
    success: boolean
    webhook_id: string

- name: update
  inputs:
    active: boolean
    description: string
    events: list[string]
    secret: string
    url: string
    webhook_id: string #required
  outputs:
    success: boolean

- name: unregister
  inputs:
    webhook_id: string #required
  outputs:
    success: boolean

- name: trigger
  inputs:
    event: string #required
    payload: any #required
    webhook_ids: list[string]
  outputs:
    success: boolean
    triggered_count: int

- name: get
  inputs:
    webhook_id: string #required
  outputs:
    active: boolean
    created_at: date
    description: string
    events: list[string]
    url: string

- name: lists
  inputs:
    active_only: boolean = false
    event: string
    limit: int = 100
    offset: int = 0
  outputs:
    total: int
    webhooks: list[webhook]

- name: test
  inputs:
    payload: any
    webhook_id: string #required
  outputs:
    error: string
    response_time_ms: int
    status_code: int
    success: boolean

- name: get_deliveries
  inputs:
    limit: int = 50
    offset: int = 0
    status: success | failed | pending
    webhook_id: string #required
  outputs:
    deliveries: list[webhook_delivery]
    total: int

- name: retry_delivery
  inputs:
    delivery_id: string #required
  outputs:
    status_code: int
    success: boolean

- name: verify_signature
  inputs:
    algorithm: sha256 | sha512 = sha256
    payload: string #required
    secret: string #required
    signature: string #required
  outputs:
    valid: boolean

- name: rotate_secret
  inputs:
    webhook_id: string #required
  outputs:
    new_secret: string
    success: boolean

- name: webhook
  class:
    webhook_id: string
    url: string
    events: list[string]
    secret: string
    active: boolean
    description: string
    created_at: date

- name: webhook_delivery
  class:
    delivery_id: string
    webhook_id: string
    event: string
    status: string
    status_code: int
    response_time_ms: int
    error: string
    created_at: date
