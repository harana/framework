- name: sign_artifact
  inputs:
    algorithm: rsa-sha256 | rsa-sha512 | ecdsa-sha256 | ed25519 = rsa-sha256
    artifact: bytes #required
    artifact_path: string
    format: pkcs7 | jws | raw = pkcs7
    private_key: string #required
    metadata: signature_metadata
  outputs:
    signature: string
    signature_format: string
    algorithm: string
    timestamp: date
    success: boolean

- name: verify_artifact
  inputs:
    algorithm: rsa-sha256 | rsa-sha512 | ecdsa-sha256 | ed25519
    artifact: bytes #required
    artifact_path: string
    format: pkcs7 | jws | raw = pkcs7
    public_key: string #required
    signature: string #required
  outputs:
    valid: boolean
    signer: string
    timestamp: date
    algorithm: string
    error: string

- name: sign_code
  inputs:
    artifact: bytes #required
    artifact_path: string
    certificate: string #required
    certificate_chain: list[string]
    description: string
    format: authenticode | codesign | jar = authenticode
    private_key: string #required
    timestamp_authority: string
  outputs:
    signed_artifact: bytes
    signature: string
    success: boolean
    timestamp: date

- name: create_detached
  inputs:
    algorithm: rsa-sha256 | rsa-sha512 | ecdsa-sha256 | ed25519 = rsa-sha256
    artifact: bytes #required
    format: pgp | smime | cms = pgp
    private_key: string #required
    armor: boolean = true
  outputs:
    signature: string
    success: boolean

- name: verify_detached
  inputs:
    algorithm: rsa-sha256 | rsa-sha512 | ecdsa-sha256 | ed25519
    artifact: bytes #required
    format: pgp | smime | cms = pgp
    public_key: string #required
    signature: string #required
  outputs:
    valid: boolean
    signer: string
    error: string

- name: sign_container
  inputs:
    digest: string
    format: cosign | notary = cosign
    image: string #required
    private_key: string #required
    registry: string
    tag: string
  outputs:
    signature: string
    signature_digest: string
    success: boolean

- name: verify_container
  inputs:
    format: cosign | notary = cosign
    image: string #required
    public_key: string #required
    registry: string
    signature: string
    tag: string
  outputs:
    valid: boolean
    signer: string
    timestamp: date
    error: string

- name: sign_jar
  inputs:
    alias: string #required
    jar_path: string #required
    keystore: string #required
    keystore_password: string #required
    private_key_password: string
    signature_algorithm: sha256with_rsa | sha512with_rsa = sha256with_rsa
    timestamp_authority: string
  outputs:
    signed_jar_path: string
    success: boolean

- name: verify_jar
  inputs:
    jar_path: string #required
    certificate: string
  outputs:
    valid: boolean
    signers: list[string]
    timestamp: date
    error: string

- name: timestamp
  inputs:
    authority_url: string #required
    digest: string #required
    hash_algorithm: sha256 | sha512 = sha256
  outputs:
    timestamp: date
    timestamp_token: string
    success: boolean

- name: signature_metadata
  class:
    signer: string
    organization: string
    email: string
    description: string
    url: string
    custom_attributes: map[string, string]

- name: signed_artifact
  class:
    artifact: bytes
    signature: string
    algorithm: string
    format: string
    timestamp: date
    signer: string
    certificate_chain: list[string]
