- action: sign_artifact
  inputs:
    algorithm: rsa-sha256 | rsa-sha512 | ecdsa-sha256 | ed25519 = rsa-sha256
    artifact: bytes
    artifact_path: string
    format: pkcs7 | jws | raw = pkcs7
    private_key: string
    metadata: signature_metadata
  outputs:
    signature: string
    signature_format: string
    algorithm: string
    timestamp: date

- action: verify_artifact
  inputs:
    algorithm: rsa-sha256 | rsa-sha512 | ecdsa-sha256 | ed25519
    artifact: bytes
    artifact_path: string
    format: pkcs7 | jws | raw = pkcs7
    public_key: string
    signature: string
  outputs:
    valid: boolean
    signer: string
    timestamp: date
    algorithm: string
    error: string

- action: sign_code
  inputs:
    artifact: bytes
    artifact_path: string
    certificate: string
    certificate_chain: list[string]
    description: string
    format: authenticode | codesign | jar = authenticode
    private_key: string
    timestamp_authority: string
  outputs:
    signed_artifact: bytes
    signature: string
    timestamp: date

- action: create_detached
  inputs:
    algorithm: rsa-sha256 | rsa-sha512 | ecdsa-sha256 | ed25519 = rsa-sha256
    artifact: bytes
    format: pgp | smime | cms = pgp
    private_key: string
    armor: boolean = true
  outputs:
    signature: string

- action: verify_detached
  inputs:
    algorithm: rsa-sha256 | rsa-sha512 | ecdsa-sha256 | ed25519
    artifact: bytes
    format: pgp | smime | cms = pgp
    public_key: string
    signature: string
  outputs:
    valid: boolean
    signer: string
    error: string

- action: sign_container
  inputs:
    digest: string
    format: cosign | notary = cosign
    image: string
    private_key: string
    registry: string
    tag: string
  outputs:
    signature: string
    signature_digest: string

- action: verify_container
  inputs:
    format: cosign | notary = cosign
    image: string
    public_key: string
    registry: string
    signature: string
    tag: string
  outputs:
    valid: boolean
    signer: string
    timestamp: date
    error: string

- action: sign_jar
  inputs:
    alias: string
    jar_path: string
    keystore: string
    keystore_password: string
    private_key_password: string
    signature_algorithm: sha256with_rsa | sha512with_rsa = sha256with_rsa
    timestamp_authority: string
  outputs:
    signed_jar_path: string

- action: verify_jar
  inputs:
    jar_path: string
    certificate: string
  outputs:
    valid: boolean
    signers: list[string]
    timestamp: date
    error: string

- action: timestamp
  inputs:
    authority_url: string
    digest: string
    hash_algorithm: sha256 | sha512 = sha256
  outputs:
    timestamp: date
    timestamp_token: string

- object: signature_metadata
  schema:
    signer: string
    organization: string
    email: string
    description: string
    url: string
    custom_attributes: map[string, string]

- object: signed_artifact
  schema:
    artifact: bytes
    signature: string
    algorithm: string
    format: string
    timestamp: date
    signer: string
    certificate_chain: list[string]

- object: signing_key
  schema:
    algorithm: rsa_sha256 | rsa_sha512 | ecdsa_sha256 | ed25519 = rsa_sha256
    created_at: date = now()
    created_by: string
    expires_at: date
    is_active: boolean = true
    key_id: string
    public_key_fingerprint: string
    updated_at: date = now()
    usage: artifact | code | container | detached = artifact

- object: signature
  schema:
    algorithm: string
    artifact_hash: string
    artifact_path: string
    created_at: date = now()
    format: pkcs7 | jws | raw | pgp | smime | cms | cosign | notary = pkcs7
    is_valid: boolean = true
    key_id: string
    signer: string

- object: signature_verification_log
  schema:
    error_message: string
    ip_address: string
    is_valid: boolean = false
    signature_id: string
    verified_at: date = now()
    verified_by: string
