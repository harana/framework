- name: create
  inputs:
    conditions: policy_conditions #required
    description: string
    effect: string #required # allow or deny
    name: string #required
    resources: list[string] #required
    actions: list[string] #required
  outputs:
    policy_id: string
    success: boolean

- name: update
  inputs:
    conditions: policy_conditions
    description: string
    effect: string
    name: string
    policy_id: string #required
    resources: list[string]
    actions: list[string]
  outputs:
    success: boolean

- name: delete
  inputs:
    policy_id: string #required
  outputs:
    success: boolean

- name: get
  inputs:
    policy_id: string #required
  outputs:
    actions: list[string]
    conditions: policy_conditions
    description: string
    effect: string
    name: string
    resources: list[string]

- name: list_policies
  inputs:
    limit: int = 100
    offset: int = 0
  outputs:
    policies: list[policy_info]
    total: int

- name: attach_to_user
  inputs:
    policy_id: string #required
    user_id: string #required
  outputs:
    success: boolean

- name: detach_from_user
  inputs:
    policy_id: string #required
    user_id: string #required
  outputs:
    success: boolean

- name: attach_to_role
  inputs:
    policy_id: string #required
    role_id: string #required
  outputs:
    success: boolean

- name: detach_from_role
  inputs:
    policy_id: string #required
    role_id: string #required
  outputs:
    success: boolean

- name: evaluate
  inputs:
    method: string #required
    context: policy_evaluation_context
    policy_id: string #required
    resource: string #required
  outputs:
    allowed: boolean
    evaluated_conditions: policy_evaluated_conditions
    reason: string

- name: policy
  class:
    policy_id: string
    name: string
    description: string
    effect: string
    actions: list[string]
    resources: list[string]
    conditions: policy_conditions

- name: policy_conditions
  class:
    conditions: map[string, any]

- name: policy_info
  class:
    policy_id: string
    name: string
    description: string
    effect: string

- name: policy_evaluation_context
  class:
    values: map[string, any]

- name: policy_evaluated_conditions
  class:
    results: map[string, boolean]
