- name: generate_registration_options
  inputs:
    attestation: none | indirect | direct | enterprise = none
    authenticator_selection: passkey_authenticator_selection
    exclude_credentials: list[passkey_credential_descriptor]
    relying_party_id: string #required
    relying_party_name: string #required
    timeout: int = 60000
    user_display_name: string #required
    user_id: string #required
    user_name: string #required
  outputs:
    challenge: string
    options: passkey_registration_options

- name: verify_registration
  inputs:
    expected_challenge: string #required
    expected_origin: string #required
    expected_rp_id: string #required
    require_user_verification: boolean = true
    response: passkey_registration_response #required
  outputs:
    aaguid: string
    attestation_object: bytes
    counter: int
    credential_backed_up: boolean
    credential_device_type: string
    credential_id: string
    credential_public_key: bytes
    verified: boolean

- name: generate_authentication_options
  inputs:
    allow_credentials: list[passkey_credential_descriptor]
    relying_party_id: string #required
    timeout: int = 60000
    user_verification: required | preferred | discouraged = preferred
  outputs:
    challenge: string
    options: passkey_authentication_options

- name: verify_authentication
  inputs:
    credential_current_counter: int #required
    credential_public_key: bytes #required
    expected_challenge: string #required
    expected_origin: string #required
    expected_rp_id: string #required
    require_user_verification: boolean = true
    response: passkey_authentication_response #required
  outputs:
    credential_backed_up: boolean
    credential_device_type: string
    new_counter: int
    verified: boolean

- name: store_credential
  inputs:
    aaguid: string
    backed_up: boolean
    counter: int #required
    credential_id: string #required
    credential_public_key: bytes #required
    device_type: string
    friendly_name: string
    transports: list[string]
    user_id: string #required
  outputs:
    passkey_id: string
    success: boolean

- name: get_user_passkeys
  inputs:
    user_id: string #required
  outputs:
    count: int
    passkeys: list[passkey_info]

- name: get_passkey
  inputs:
    credential_id: string #required
  outputs:
    backed_up: boolean
    counter: int
    created_at: date
    credential_id: string
    credential_public_key: bytes
    device_type: string
    friendly_name: string
    last_used_at: date
    passkey_id: string
    transports: list[string]
    user_id: string

- name: update_counter
  inputs:
    credential_id: string #required
    new_counter: int #required
  outputs:
    success: boolean

- name: delete_passkey
  inputs:
    passkey_id: string #required
    user_id: string #required
  outputs:
    success: boolean

- name: update_passkey_name
  inputs:
    friendly_name: string #required
    passkey_id: string #required
  outputs:
    success: boolean

- name: check_support
  inputs:
    user_agent: string #required
  outputs:
    conditional_mediation: boolean
    platform_authenticator: boolean
    user_verifying_platform_authenticator: boolean

- name: passkey
  class:
    passkey_id: string
    credential_id: string
    user_id: string
    credential_public_key: bytes
    counter: int
    device_type: string
    backed_up: boolean
    friendly_name: string
    created_at: date
    last_used_at: date

- name: passkey_authenticator_selection
  class:
    authenticator_attachment: string
    resident_key: string
    require_resident_key: boolean
    user_verification: string

- name: passkey_credential_descriptor
  class:
    id: string
    type: string
    transports: list[string]

- name: passkey_registration_options
  class:
    rp: passkey_relying_party
    user: passkey_user
    challenge: string
    pub_key_cred_params: list[passkey_cred_param]
    timeout: int
    attestation: string

- name: passkey_relying_party
  class:
    id: string
    name: string

- name: passkey_user
  class:
    id: string
    name: string
    display_name: string

- name: passkey_cred_param
  class:
    type: string
    alg: int

- name: passkey_registration_response
  class:
    id: string
    raw_id: string
    response: passkey_authenticator_attestation_response
    type: string

- name: passkey_authenticator_attestation_response
  class:
    client_data_json: string
    attestation_object: string

- name: passkey_authentication_options
  class:
    challenge: string
    timeout: int
    rp_id: string
    allow_credentials: list[passkey_credential_descriptor]
    user_verification: string

- name: passkey_authentication_response
  class:
    id: string
    raw_id: string
    response: passkey_authenticator_assertion_response
    type: string

- name: passkey_authenticator_assertion_response
  class:
    client_data_json: string
    authenticator_data: string
    signature: string
    user_handle: string

- name: passkey_info
  class:
    passkey_id: string
    credential_id: string
    friendly_name: string
    device_type: string
    created_at: date
    last_used_at: date
