- action: check_permission
  inputs:
    method: string
    resource: string
    user_id: string
  outputs:
    allowed: boolean
    reason: string

- action: grant_permission
  inputs:
    method: string
    conditions: user_permission_conditions
    expires_at: date
    resource: string
    user_id: string
  outputs:
    permission_id: string

- action: revoke_permission
  inputs:
    permission_id: string
    user_id: string

- action: list_permissions
  inputs:
    resource: string
    user_id: string
  outputs:
    permissions: list[user_permission_info]
    total: int

- action: assign_role
  inputs:
    role_id: string
    user_id: string

- action: remove_role
  inputs:
    role_id: string
    user_id: string

- action: list_roles
  inputs:
    user_id: string
  outputs:
    roles: list[user_role_info]
    total: int

- action: get_effective_permissions
  inputs:
    resource: string
    user_id: string
  outputs:
    permissions: list[effective_permission]
    sources: list[permission_source]

- object: user_permission
  schema:
    permission_id: string
    user_id: string
    method: string
    resource: string
    conditions: user_permission_conditions
    expires_at: date

- object: user_permission_conditions
  schema:
    conditions: map[string, any]

- object: user_permission_info
  schema:
    permission_id: string
    method: string
    resource: string
    expires_at: date

- object: user_role_info
  schema:
    role_id: string
    name: string
    assigned_at: date

- object: effective_permission
  schema:
    method: string
    resource: string
    allowed: boolean

- object: permission_source
  schema:
    source_type: string
    source_id: string
    name: string
