- action: check_permission
  inputs:
    method: string #required
    resource: string #required
    user_id: string #required
  outputs:
    allowed: boolean
    reason: string

- action: grant_permission
  inputs:
    method: string #required
    conditions: user_permission_conditions
    expires_at: date
    resource: string #required
    user_id: string #required
  outputs:
    permission_id: string
    success: boolean

- action: revoke_permission
  inputs:
    permission_id: string #required
    user_id: string #required
  outputs:
    success: boolean

- action: list_permissions
  inputs:
    resource: string
    user_id: string #required
  outputs:
    permissions: list[user_permission_info]
    total: int

- action: assign_role
  inputs:
    role_id: string #required
    user_id: string #required
  outputs:
    success: boolean

- action: remove_role
  inputs:
    role_id: string #required
    user_id: string #required
  outputs:
    success: boolean

- action: list_roles
  inputs:
    user_id: string #required
  outputs:
    roles: list[user_role_info]
    total: int

- action: get_effective_permissions
  inputs:
    resource: string
    user_id: string #required
  outputs:
    permissions: list[effective_permission]
    sources: list[permission_source]

- object: user_permission
  class:
    permission_id: string
    user_id: string
    method: string
    resource: string
    conditions: user_permission_conditions
    expires_at: date

- object: user_permission_conditions
  class:
    conditions: map[string, any]

- object: user_permission_info
  class:
    permission_id: string
    method: string
    resource: string
    expires_at: date

- object: user_role_info
  class:
    role_id: string
    name: string
    assigned_at: date

- object: effective_permission
  class:
    method: string
    resource: string
    allowed: boolean

- object: permission_source
  class:
    source_type: string
    source_id: string
    name: string
