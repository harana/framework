- name: schema
  inputs:
    data: any #required
    schema: validation_schema #required
    strict: boolean = true
  outputs:
    errors: list[validation_error]
    valid: boolean

- name: field
  inputs:
    field_name: string
    rules: list[string] #required
    value: any #required
  outputs:
    errors: list[string]
    valid: boolean

- name: email_format
  inputs:
    email: string #required
  outputs:
    reason: string
    valid: boolean

- name: url
  inputs:
    allowed_schemes: list[string]
    url: string #required
  outputs:
    reason: string
    valid: boolean

- name: phone
  inputs:
    country_code: string
    phone: string #required
  outputs:
    country: string
    formatted: string
    valid: boolean

- name: date
  inputs:
    date: string #required
    format: string = "iso8601"
  outputs:
    parsed: date
    reason: string
    valid: boolean

- name: json
  inputs:
    json_string: string #required
  outputs:
    error: string
    parsed: any
    valid: boolean

- name: credit_card
  inputs:
    number: string #required
    luhn: boolean = true
  outputs:
    card_type: string
    last_four: string
    valid: boolean

- name: uuid
  inputs:
    uuid: string #required
    version: int
  outputs:
    valid: boolean
    version: int

- name: ip
  inputs:
    ip: string #required
    version: 4 | 6 | any = any
  outputs:
    is_private: boolean
    valid: boolean
    version: int

- name: password
  inputs:
    min_length: int = 8
    password: string #required
    require_lowercase: boolean = true
    require_numbers: boolean = true
    require_symbols: boolean = false
    require_uppercase: boolean = true
  outputs:
    strength: weak | fair | strong | very_strong
    suggestions: list[string]
    valid: boolean

- name: sanitize_html
  inputs:
    allowed_attributes: html_allowed_attributes
    allowed_tags: list[string]
    html: string #required
  outputs:
    removed_count: int
    sanitized: string

- name: validation_result
  class:
    valid: boolean
    errors: list[validation_error]
    field_name: string
    value: any

- name: validation_schema
  class:
    type: string
    properties: map[string, any]
    required: list[string]

- name: validation_error
  class:
    path: string
    message: string
    code: string

- name: html_allowed_attributes
  class:
    global: list[string]
    per_tag: map[string, list[string]]
