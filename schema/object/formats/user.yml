- name: User Permission
  type: user_permission
  id: [user_id, resource, action]
  schema:
    - action: String #required #max(100)
    - conditions: String? # JSON
    - expires_at: Date?
    - granted_at: Date = now()
    - granted_by: Id? -> User.id
    - resource: String #required #max(200)
    - user_id: Id #required -> User.id

- name: Effective Permission
  type: effective_permission
  id: [user_id, resource, action]
  schema:
    - action: String #required #max(100)
    - allowed: Boolean = false
    - resource: String #required #max(200)
    - source_id: String? #max(200)
    - source_type: Direct | Role | Group | Policy = Direct
    - user_id: Id #required -> User.id
