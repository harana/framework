- name: passkey_credential
  id: [credential_id]
  schema:
    - aaguid: string? #max(100)
    - backed_up: boolean = false
    - counter: int = 0 #min(0)
    - created_at: date = now()
    - credential_id: string #required #unique #max(500)
    - device_type: string? #max(50)
    - friendly_name: string? #max(200)
    - is_active: boolean = true
    - last_used_at: date?
    - public_key_fingerprint: string? #max(128)
    - transports: string? # json array
    - updated_at: date = now()
    - user_id: id #required -> user.id

- name: passkey_challenge
  id: [challenge]
  schema:
    - challenge: string #required #unique #max(500)
    - created_at: date = now()
    - expires_at: date #required
    - rp_id: string #required #max(255)
    - type: registration | authentication = registration
    - used: boolean = false
    - user_id: string? #max(200)

- name: passkey_auth_log
  id: [credential_id, authenticated_at]
  schema:
    - authenticated_at: date = now()
    - credential_id: string #required #max(500)
    - ip_address: string? #max(45)
    - success: boolean = true
    - user_agent: string? #max(500)
    - user_id: id #required -> user.id
