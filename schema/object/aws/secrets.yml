- name: AWS Secrets Manager Secret
  type: aws_secrets_manager_secret
  id: [account_id, name]
  schema:
    - account_id: String #required #max(20)
    - arn: String? #max(255)
    - created_at: Date = now()
    - deleted_at: Date?
    - description: String? #max(500)
    - kms_key_id: String? #max(255)
    - last_changed_at: Date?
    - last_rotated_at: Date?
    - name: String #required #unique #max(512)
    - region: String? #max(50)
    - rotation_enabled: Boolean = false
    - rotation_lambda_arn: String? #max(255)
    - rotation_rules: String? # JSON
    - tags: String? # JSON
    - updated_at: Date = now()

- name: AWS Secrets Manager Secret Version
  type: aws_secrets_manager_secret_version
  id: [secret_id, version_id]
  schema:
    - created_at: Date = now()
    - secret_id: Id #required -> AwsSecretsManagerSecret.id
    - version_id: String #required #unique #max(64)
    - version_stages: String? # JSON list

- name: AWS Secrets Manager Secret Replication
  type: aws_secrets_manager_secret_replication
  id: [secret_id, region]
  schema:
    - created_at: Date = now()
    - kms_key_id: String? #max(255)
    - last_accessed_at: Date?
    - region: String #required #max(50)
    - secret_id: Id #required -> AwsSecretsManagerSecret.id
    - status: InSync | Failed | InProgress = InProgress
    - status_message: String? #max(500)
    - updated_at: Date = now()

- name: AWS Secrets Manager Access Log
  type: aws_secrets_manager_access_log
  id: [secret_id, accessed_at]
  schema:
    - accessed_at: Date = now()
    - action: GetValue | PutValue | Create | Update | Delete | Rotate | Tag | Untag = GetValue
    - ip_address: String? #max(45)
    - secret_id: Id #required -> AwsSecretsManagerSecret.id
    - success: Boolean = true
    - user_arn: String? #max(255)
