- object: aws_secrets_manager_secret
  id: [account_id, name]
  schema:
    - account_id: string #max(20)
    - arn: string? #max(255)
    - created_at: date = now()
    - deleted_at: date?
    - description: string? #max(500)
    - kms_key_id: string? #max(255)
    - last_changed_at: date?
    - last_rotated_at: date?
    - name: string #unique #max(512)
    - region: string? #max(50)
    - rotation_enabled: boolean = false
    - rotation_lambda_arn: string? #max(255)
    - rotation_rules: string? # json
    - tags: string? # json
    - updated_at: date = now()

- object: aws_secrets_manager_secret_version
  id: [secret_id, version_id]
  schema:
    - created_at: date = now()
    - secret_id: id -> aws_secrets_manager_secret.id
    - version_id: string #unique #max(64)
    - version_stages: string? # json list

- object: aws_secrets_manager_secret_replication
  id: [secret_id, region]
  schema:
    - created_at: date = now()
    - kms_key_id: string? #max(255)
    - last_accessed_at: date?
    - region: string #max(50)
    - secret_id: id -> aws_secrets_manager_secret.id
    - status: in_sync | failed | in_progress = in_progress
    - status_message: string? #max(500)
    - updated_at: date = now()

- object: aws_secrets_manager_access_log
  id: [secret_id, accessed_at]
  schema:
    - accessed_at: date = now()
    - action: get_value | put_value | create | update | delete | rotate | tag | untag = get_value
    - ip_address: string? #max(45)
    - secret_id: id -> aws_secrets_manager_secret.id
    - success: boolean = true
    - user_arn: string? #max(255)
