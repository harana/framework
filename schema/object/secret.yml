- name: Secret
  type: secret
  id: [key]
  schema:
    - created_at: Date = now()
    - created_by: Id? -> User.id
    - is_rotatable: Boolean = false
    - key: String #required #unique #max(200)
    - last_rotated_at: Date?
    - updated_at: Date = now()
    - value: String #required #encrypted
    - version: int = 1 #min(1)

- name: Secret Version
  type: secret_version
  id: [secret_id, version]
  schema:
    - created_at: Date = now()
    - created_by: Id? -> User.id
    - is_active: Boolean = true
    - secret_id: Id #required -> Secret.id
    - value: String #required #encrypted
    - version: int #required #min(1)

- name: Secret Access Log
  type: secret_access_log
  id: [secret_id, accessed_at, user_id]
  schema:
    - accessed_at: Date = now()
    - action: Read | Write | Rotate | Delete = Read
    - ip_address: String? #max(45)
    - secret_id: Id #required -> Secret.id
    - user_id: Id? -> User.id
