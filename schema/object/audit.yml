- object: audit_event
  id: [actor_id, resource_id, created_at]
  schema:
    - action: string #max(200)
    - actor_id: string #max(200)
    - actor_type: user | service | system = user
    - created_at: date = now()
    - details: string?
    - ip_address: string? #max(45)
    - metadata: string?
    - outcome: success | failure | partial = success
    - resource_id: string #max(200)
    - resource_type: string #max(100)
    - user_agent: string? #max(500)

- object: audit_alert
  schema:
    - action_pattern: string? #max(500)
    - actor_pattern: string? #max(500)
    - created_at: date = now()
    - description: string? #max(500)
    - is_active: boolean = true
    - last_triggered_at: date?
    - notification_channel: string? #max(100)
    - resource_pattern: string? #max(500)
    - updated_at: date = now()

- object: audit_export
  id: [created_at]
  schema:
    - completed_at: date?
    - created_at: date = now()
    - download_url: string? #url
    - end_time: date #required
    - expires_at: date?
    - file_size: int? #min(0)
    - format: json | csv | parquet = json
    - record_count: int? #min(0)
    - start_time: date #required
    - status: pending | processing | completed | failed = pending
