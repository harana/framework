- name: Signing Key
  type: signing_key
  id: [key_id]
  schema:
    - algorithm: RsaSha256 | RsaSha512 | EcdsaSha256 | Ed25519 = RsaSha256
    - created_at: Date = now()
    - created_by: Id? -> User.id
    - expires_at: Date?
    - is_active: Boolean = true
    - key_id: String #required #unique #max(200)
    - public_key_fingerprint: String? #max(128)
    - updated_at: Date = now()
    - usage: Artifact | Code | Container | Detached = Artifact

- name: Signature
  type: signature
  id: [artifact_hash, key_id]
  schema:
    - algorithm: String #required #max(50)
    - artifact_hash: String #required #max(128)
    - artifact_path: String? #max(2000)
    - created_at: Date = now()
    - format: Pkcs7 | Jws | Raw | Pgp | Smime | Cms | Cosign | Notary = Pkcs7
    - is_valid: Boolean = true
    - key_id: String #required #max(200)
    - signer: String? #max(500)

- name: Signature Verification Log
  type: signature_verification_log
  id: [signature_id, verified_at]
  schema:
    - error_message: String? #max(1000)
    - ip_address: String? #max(45)
    - is_valid: Boolean = false
    - signature_id: Id #required -> Signature.id
    - verified_at: Date = now()
    - verified_by: Id? -> User.id
